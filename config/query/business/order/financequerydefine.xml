<?xml version="1.0" encoding="UTF-8"?>
<root>
  <query>
    <pool></pool>    
    <name value="contractListForPaymenRequest" />
     <where>
        <w name="A.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	    <w name="A.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
    	<w name="A.finishStatus" des="" reqName="finishStatus"  dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="A.finishStatus" des="" reqName="finishStatusU" dtype="ch" oper="&lt;&gt;" lg="AND" bt="" />
        <w name="A.contractId"   des="" reqName="contractId"    dtype="ch" oper="in"  lg="AND" bt="" />
        <w name="A.agreementDate"   des="" reqName="agreementDate" dtype="ch" oper="&lt;"  lg="AND" bt="" />
        <w name="A.supplierId"      des="" reqName="supplierId"    dtype="ch" oper="="  lg="AND" bt="" />
   	  	<w name="A.purchaser"       des="" reqName="userId"        dtype="ch" oper="="  lg="AND" bt="" />
   	  	
   	  	<w name="DATE_FORMAT(A.stockInDate,'%Y-%m')" des="" reqName="monthday"   dtype="ch" oper="="   lg="AND" bt="" />
   	  	<w name="DATE_FORMAT(A.stockInDate,'%Y')"    des="" reqName="year"       dtype="ch" oper="="   lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.chargeback" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="a.detailPaymentId" alias="" ctype="" />
      <f name="IFNULL(a.paymentId,'')" alias="paymentId" ctype="" />
      <f name="a.payable" alias="" ctype="" />
      <f name="a.stockInDate" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.agreementDate" alias="" ctype="" />
      <f name="a.paymentTerm" alias="" ctype="" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatus" ctype="应付款状态" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatusId" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="a.stockinQty" alias="" ctype="" />
      <f name="a.contractQty" alias="" ctype="" />
      <f name="a.invoiceDate" alias="" ctype="" />
      <f name="a.purchaser" alias="" ctype="" />
      <f name="a.purchaser" alias="purchaserName" ctype="采购人员" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_paymentlistfromcontract a where a.deleteFlag='0' AND supplierId != '0574YZ00'</from>
    <orderby>a.supplierId ,a.stockInDate</orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="contractListForPaymenManage" />
     <where>
    	<w name="A.finishStatus" des="" reqName="finishStatus" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="IFNULL(a.paymentId,'')" alias="paymentId" ctype="" />
      <f name="a.stockInDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.agreementDate" alias="" ctype="" />
      <f name="a.paymentTerm" alias="" ctype="" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatus" ctype="应付款状态" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatusId" ctype="" />     
      <f name="a.stockinQty" alias="" ctype="" />
      <f name="a.contractQty" alias="" ctype="" />
      <f name="a.purchaser" alias="" ctype="" />
      <f name="a.purchaser" alias="purchaserName" ctype="采购人员" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>
	  (
		SELECT
			a.taxExcluded,
			a.taxes,
			a.taxRate,
			IFNULL(sum(REPLACE(a.contractStorage, ',', '')),0) stockinQty ,
			IFNULL(sum(REPLACE (a.quantity, ',', '')),0) contractQty,
			a.YSId AS YSId,
			format(sum(REPLACE (format((REPLACE (a.price, ',', '') * REPLACE (a.quantity, ',', '')),2	),',','')),2) AS totalPrice,
			a.contractId AS contractId,
			a.supplierId AS supplierId,
			a.supplierName AS supplierName,
			c.shortName AS shortName,
			a.status AS contractStatus,
			ifnull(b.paymentId, '') AS paymentId,
			ifnull(b.finishDate, '-') AS finishDate,
			ifnull(SUM(REPLACE(b.paymentAmount,',','')),0) AS paymentAmount,
			ifnull(c.paymentTerm, '60') AS paymentTerm,
			a.stockInDate AS stockInDate,
			(a.stockInDate + INTERVAL ifnull(c.paymentTerm, 60) DAY) AS agreementDate,
			ifnull(b.finishStatus, '010') AS finishStatus,
			a.deleteFlag AS deleteFlag,
			a.purchaser,
			ucase(
				concat_ws(
					',',
					a.fullField,
					b.paymentId,
					c.supplierName
				)
			) AS fullField
		FROM
			v_purchaseorderdetail a
			LEFT JOIN 
				(
				SELECT
					a.paymentId AS paymentId,
					a.totalPayable AS totalPayable,
					a.requestDate AS requestDate,
					a.contractIds AS contractIds,
					a.approvalDate AS approvalDate,
					b.contractId,a.finishDate,a.finishStatus,
					c.paymentAmount,
					a.invoiceNumber
				FROM
					b_payment a
					LEFT JOIN b_paymenthistory c ON  c.paymentId = a.paymentId AND (c.deleteFlag = '0') 
					LEFT JOIN b_paymentdetail b ON b.paymentId=a.paymentId AND (b.deleteFlag = '0') 
				)
				 b ON a.contractId = b.contractId
			LEFT JOIN b_supplier c ON a.supplierId = c.supplierId AND (c.deleteFlag = '0')
		WHERE  #
		GROUP BY a.contractId 
		) a
		WHERE a.stockinQty >= a.contractQty
	</from>
    <orderby>a.supplierId ,a.stockInDate</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="forPaymenRequestByContractId" />
     <where>
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.chargeback" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="a.detailPaymentId" alias="" ctype="" />
      <f name="IFNULL(a.paymentId,'')" alias="paymentId" ctype="" />
      <f name="a.payable" alias="" ctype="" />
      <f name="a.stockInDate" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.agreementDate" alias="" ctype="" />
      <f name="a.paymentTerm" alias="" ctype="" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatus" ctype="应付款状态" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatusId" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="a.contractStorage" alias="" ctype="" />
      <f name="a.contractQty" alias="" ctype="" />
      <f name="a.invoiceDate" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>
    	(
    	SELECT
			a.taxExcluded,
			a.taxes,
			a.taxRate,
			IFNULL(sum(REPLACE (a.quantity, ',', '')),0) contractQty,
		  g.quantity AS reverseQty,
			a.YSId AS YSId,
			format(sum(REPLACE (format((REPLACE (a.price, ',', '') * REPLACE (a.quantity, ',', '')),2	),',','')),2) AS totalPrice,
			if(a.deductFlag='1',a.deduct,(IFNULL(f.cost,0) - IFNULL(e.chargeback,0) - IFNULL(g.quantity,0) * REPLACE(a.price,',',''))) chargeback,
			a.contractId AS contractId,
			a.supplierId AS supplierId,
			a.supplierName AS supplierName,
			c.shortName AS shortName,
			a.status AS contractStatus,
			b.detailPaymentId AS detailPaymentId,
			ifnull(b.paymentId, '') AS paymentId,
			b.payable AS payable,
			b.chargeType,
			b.requestDate AS requestDate,
			b.approvalDate AS approvalDate,
			b.approvalStatus AS approvalStatus,
			b.approvalUser AS approvalUser,
			b.invoiceNumber,
			b.detailRecordId,
			b.invoiceDate,
			ifnull(b.finishDate, '-') AS finishDate,
			ifnull(c.paymentTerm, '60') AS paymentTerm,
			a.stockInDate AS stockInDate,
			(a.stockInDate + INTERVAL ifnull(c.paymentTerm, 60) DAY) AS agreementDate,
			ifnull(b.finishStatus, '010') AS finishStatus,
			a.contractStorage,
			a.deleteFlag AS deleteFlag
		FROM
			v_purchaseorderdetail a
				LEFT JOIN v_paymentdetail b ON a.contractId = b.contractId AND (b.deleteFlag = '0')
				LEFT JOIN b_supplier c ON a.supplierId = c.supplierId AND (c.deleteFlag = '0')
				LEFT JOIN v_orderexpanse_group_contract e ON a.contractId = e.contractId
				LEFT JOIN v_orderexpansegroup f ON a.contractId = f.contractId
				LEFT JOIN v_stockin_reverse_groupbycontract g ON a.contractId = g.contractId
		WHERE a.supplierId = '#0' AND REPLACE(a.contractStorage,',','')+0 > 0 AND b.paymentId is null
		GROUP BY a.contractId 
		) a 
	</from>
    <orderby>a.stockInDate</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="paymenRequestList" />
     <where>
        <w name="A.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	    <w name="A.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
    	<w name="A.approvalStatus" des="" reqName="approvalStatus" dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="A.approvalDate"   des="" reqName="approvalDate"   dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="A.finishStatus"   des="" reqName="finishStatus"   dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.paymentId" alias="" ctype="" />
      <f name="a.contractIds" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="a.totalPayable" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.finishStatus" alias="" ctype="" />
      <f name="a.applicant" alias="" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="IFNULL(invoiceDate,a.approvalDate)" alias="invoiceDate" ctype="" />
      <f name="a.invoiceType" alias="invoiceType" ctype="发票类型" />
      <f name="a.invoiceNumber" alias="" ctype="" />
      <f name="a.invoiceCheckUser" alias="" ctype="" />
      <f name="a.invoiceCheckDate" alias="" ctype="" />
      <f name="a.invoiceCheckFeedback" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="a.invoiceCheckStatus" alias="" ctype="审核结果" />
      <f name="a.invoiceCheckStatus" alias="invoiceCheckStatusId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_paymentapprovallist a where a.deleteFlag='0'</from>
    <orderby>a.paymentId</orderby>
    <groupby>a.paymentId</groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="paymenApprovalList" />
     <where>
        <w name="A.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	    <w name="A.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
    	<w name="A.finishStatus" des="" reqName="finishStatus" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.paymentId" alias="" ctype="" />
      <f name="a.contractIds" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="a.totalPayable" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.applicant" alias="" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="a.paymentHistoryId" alias="" ctype="" />
      <f name="format(IFNULL(a.paymentAmount,0),2)" alias="paymentAmount" ctype="" />
      <f name="a.paymentMethod" alias="" ctype="" />
      <f name="a.paymentMethod" alias="paymentMethodName" ctype="付款方式" />
      <f name="a.finishUser" alias="" ctype="" />
      <f name="a.finishStatus" alias="" ctype="应付款状态" />
      <f name="a.finishStatus" alias="finishStatusId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_paymenthistorylist a where a.deleteFlag='0'</from>
    <orderby>finishStatus,a.paymentId,a.paymentHistoryId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="getContractDetailById" />
     <where>
       <w name="A.contractId" des=""  reqName="contractId" dtype="ch" oper="in"  lg="AND" bt="" />
    </where>
  <select>
      <f name="A.recordId" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.paymentTerm" alias="" ctype="" />
      <f name="A.contractId" alias="" ctype="" />
      <f name="A.supplierId" alias="" ctype="" />
      <f name="A.shortName" alias="" ctype="" />
      <f name="A.supplierName" alias="" ctype="" />
      <f name="'0'" alias="extra" ctype="" />
      <f name="A.deliveryDate" alias="" ctype="" />
      <f name="FORMAT(REPLACE(A.total,',',''),2)" alias="total" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_purchaseorder a  where a.deleteFlag='0'</from>
    <orderby>a.contractId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="paymentDetailById" />
    <where>
    	<w name="A.paymentId" des="" reqName="paymentId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.paymentId" alias="" ctype="" />
      <f name="a.applicant" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.totalPayable" alias="" ctype="" />
      <f name="a.finishStatus" alias="" ctype="应付款状态" />
      <f name="a.finishStatus" alias="finishStatusId" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.contractIds" alias="" ctype="" />
      <f name="a.invoiceDate" alias="" ctype="" />
      <f name="a.invoiceType" alias="" ctype="发票类型" />
      <f name="b.contractId" alias="" ctype="" />
      <f name="b.payable" alias="" ctype="" />
      <f name="a.invoiceNumber" alias="" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="a.invoiceCheckStatus" alias="" ctype="审核结果" />
      <f name="a.invoiceCheckStatus" alias="invoiceCheckStatusId" ctype="" />
      <f name="a.invoiceCheckDate" alias="" ctype="" />
      <f name="a.invoiceCheckFeedback" alias="" ctype="" />
      <f name="a.approvalFeedback" alias="" ctype="" />
      <f name="c.loginName" alias="applicantName" ctype="" />
      <f name="d.loginName" alias="invoiceCheckUser" ctype="" />
      <f name="e.loginName" alias="approvalUser" ctype="" />
      <f name="IFNULL(a.paymentType,'010')" alias="paymentType" ctype="付款类别" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>
   		b_payment a 
	   		LEFT JOIN b_paymentdetail b ON a.paymentId=b.paymentId AND b.deleteFlag='0' 
	   		LEFT JOIN s_user c ON a.applicant=c.userId AND c.deleteFlag='0' 
	   		LEFT JOIN s_user d ON a.invoiceCheckUser=d.userId AND d.deleteFlag='0' 
	   		LEFT JOIN s_user e ON a.approvalUser=e.userId AND e.deleteFlag='0' 
   		WHERE a.deleteFlag='0'</from>
    <groupby></groupby>
    <having></having>    
    <orderby></orderby>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getMAXRequisitionId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_requisition a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  
  <query>
    <pool></pool>    
    <name value="getMAXPaymentId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_payment a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query> 
  <query>
    <pool></pool>    
    <name value="paymentHistoryMAXId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_paymenthistory a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="sumPaymentHistoryByPaymentId" />
     <where>
       <w name="a.paymentId" des=""  reqName="paymentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name="a.paymentId" alias="" ctype="" />
      <f name="sum(replace(A.paymentAmount,',',''))" alias="paymentAmount" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_paymenthistory a WHERE a.deleteFlag='0'</from>
    <orderby></orderby>
    <groupby>a.paymentId</groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="paymentHistoryList" />
    <where>
    	<w name="A.paymentId" des="" reqName="paymentId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.paymentHistoryId" alias="" ctype="" />
      <f name="a.paymentId" alias="" ctype="" />
      <f name="a.paymentMethod" alias="" ctype="付款方式" />
      <f name="IFNULL(format(REPLACE(a.paymentAmount,',',''),2),0)" alias="paymentAmount" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.currency" alias="" ctype="币种" />
      <f name="c.loginName" alias="finishUser" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>b_paymenthistory a  LEFT JOIN s_user c ON a.finishUser=c.userId AND c.deleteFlag='0' WHERE a.deleteFlag='0'</from>
    <groupby></groupby>
    <having></having>    
    <orderby>a.paymentHistoryId</orderby>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="contractListForPaymenRequestById" />
     <where>
         <w name="A.contractId"   des="" reqName="contractId" dtype="ch" oper="in"  lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.chargeback" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.shortName" alias="" ctype="" />
      <f name="a.supplierName" alias="" ctype="" />
      <f name="a.detailPaymentId" alias="" ctype="" />
      <f name="a.detailRecordId" alias="" ctype="" />
      <f name="IFNULL(a.paymentId,'')" alias="paymentId" ctype="" />
      <f name="a.payable" alias="" ctype="" />
      <f name="a.stockInDate" alias="" ctype="" />
      <f name="a.requestDate" alias="" ctype="" />
      <f name="a.finishDate" alias="" ctype="" />
      <f name="a.agreementDate" alias="" ctype="" />
      <f name="a.paymentTerm" alias="" ctype="" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatus" ctype="应付款状态" />
      <f name="IFNULL(a.finishStatus,'010')" alias="finishStatusId" ctype="" />
      <f name="a.approvalDate" alias="" ctype="" />
      <f name="a.approvalStatus" alias="" ctype="审核结果" />
      <f name="a.approvalStatus" alias="approvalStatusId" ctype="" />
      <f name="group_concat(b.receiptId SEPARATOR ',')" alias="receiptId" ctype="" />
      <f name="a.taxExcluded" alias="" ctype="" />
      <f name="a.taxes" alias="" ctype="" />
      <f name="concat( a.taxRate*100/100,'%')" alias="taxRate" ctype="" />
      <f name="a.chargeType" alias="" ctype="扣款方式" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_paymentlistfromcontract a LEFT JOIN b_purchasestockin b ON b.contractId=a.contractId AND b.deleteFlag='0' where a.deleteFlag='0' AND a.supplierId != '0574YZ00'</from>
    <orderby>A.YSId </orderby>
    <groupby>a.contractId</groupby>
    <having></having>
	<power>
	</power>    
  </query>
	<query>
		<pool></pool>    
    	<name value="financeReprotForDaybook" />
     	<where></where>
	  	<select>
	      <f name="dataFlag" alias="" ctype="" />
	      <f name="YSId" alias="" ctype="" />
	      <f name="a.contractId" alias="" ctype="" />
	      <f name="a.supplierName" alias="" ctype="" />
	      <f name="a.depotId" alias="" ctype="仓库分类" />
	      <f name="a.receiptId" alias="receiptId" ctype="" />
	      <f name="a.checkInDate" alias="" ctype="" />
	      <f name="a.sortDate" alias="" ctype="" />
	      <f name="a.stockinType" alias="" ctype="入库单据类型" />
	      <f name="stockoutType" alias="" ctype="出库单据类型" />
	      <f name="requisitionType" alias="" ctype="领料类别" />
	      <f name="a.materialId" alias="" ctype="" />
      	  <f name="a.materialName" alias="" ctype="" />
      	  <f name="a.unit" alias="" ctype="计量单位" />
	      <f name="a.quantity" alias="" ctype="" />
	      <f name="a.price" alias="" ctype="" />
      	  <f name="a.newPrice" alias="" ctype="" />
      	  <f name="a.total" alias="" ctype="" />
	  	</select>
	    <from>
	    	(
	    	SELECT
				'I' dataFlag,
				IFNULL(A.YSId, a.contractId) YSId,
				a.contractId,
				a.supplierName,
				a.depotId,
				a.receiptId receiptId,
				a.checkInDate,
				a.checkInDate sortDate,
				a.stockinType,
				'0' stockoutType,
				IFNULL('', '060') requisitionType,
				a.materialId,
				a.materialName,
				a.unit,
				a.quantity,
				b.price,
				format(	( ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 ), 6 ) newPrice,
				format( ( ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull( REPLACE (a.quantity, ',', ''), 0)),2) total
			FROM
				v_purchasestockindetail a
			LEFT JOIN v_purchaseorderdetail b ON a.contractId = b.contractId
			AND a.materialId = b.materialId
			AND b.deleteFlag = '0'
			WHERE
				A.checkInDate &gt; '#0' AND A.checkInDate &lt; '#1' 
			UNION
				SELECT
					'O' dataFlag,
					b.YSId YSId,
					'' contractId,
					'' supplierName,
					b.depotId,
					b.stockOutId receiptId,
					b.checkOutDate,
					b.checkOutDate sortDate,
					'0' stockinType,
					b.stockoutType,
					IFNULL(c.requisitionType, '060') requisitionType,
					b.materialId,
					b.materialName,
					b.unit,
					b.quantity,
					b.price,
					format((ifnull(REPLACE(b.price, ',', ''), 0) / 1.17),6) newPrice,
					format((ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull(REPLACE (b.quantity, ',', ''),
								0)),2) total
				FROM
					v_stockout b
				LEFT JOIN v_requisitiondetail c ON b.requisitionId = c.requisitionId AND b.materialId = c.materialId 	AND c.deleteFlag = '0'
				WHERE
					b.checkOutDate &gt; '#0' 	AND b.checkOutDate &lt; '#1' 
			
			UNION
				SELECT
					'U' dataFlag,
					'库存盘点' YSId,
					'' contractId,
					'' supplierName,
					'***' depotId,
					'*** ' receiptId,
					DATE_FORMAT(b.createTime, '%Y-%m-%d') createTime,
					DATE_FORMAT(b.createTime, '%Y-%m-%d') sortDate,
					'0' stockinType,
					'' stockoutType,
					'' requisitionType,
					b.materialId,
					d.materialName,
					'' unit,
					b.quantity,
					b.price,
					format(
						(
							ifnull(REPLACE(b.price, ',', ''), 0) / 1.17
						),
						6
					) newPrice,
					format(
						(
							ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull(
								REPLACE (b.quantity, ',', ''),
								0
							)
						),
						2
					) total
				FROM
					b_inventoryhistory b
				LEFT JOIN b_pricereference c ON b.materialId = c.materialId 	AND c.deleteFlag = '0'
				LEFT JOIN b_material d ON b.materialId = d.materialId
				WHERE
					b.createTime &gt; '#0' 	AND b.createTime &lt; '#1'
 	    	) a
	    	</from>
	
    <orderby>sortDate</orderby>
	</query>
	<query>
		<pool></pool>    
    	<name value="financeReprotForDaybookBymaterialId" />
     	<where></where>
	  	<select>
	      <f name="dataFlag" alias="" ctype="" />
	      <f name="YSId" alias="" ctype="" />
	      <f name="a.contractId" alias="" ctype="" />
	      <f name="a.supplierName" alias="" ctype="" />
	      <f name="a.depotId" alias="" ctype="仓库分类" />
	      <f name="a.receiptId" alias="receiptId" ctype="" />
	      <f name="a.checkInDate" alias="" ctype="" />
	      <f name="a.sortDate" alias="" ctype="" />
	      <f name="a.stockinType" alias="" ctype="入库单据类型" />
	      <f name="stockoutType" alias="" ctype="出库单据类型" />
	      <f name="requisitionType" alias="" ctype="领料类别" />
	      <f name="a.materialId" alias="" ctype="" />
      	  <f name="a.materialName" alias="" ctype="" />
      	  <f name="a.unit" alias="" ctype="计量单位" />
	      <f name="a.quantity" alias="" ctype="" />
	      <f name="a.price" alias="" ctype="" />
      	  <f name="a.newPrice" alias="" ctype="" />
      	  <f name="a.total" alias="" ctype="" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
	    <from>
	    	(
	    	SELECT
				'I' dataFlag,
				IFNULL(A.YSId, a.contractId) YSId,
				a.contractId,
				a.supplierName,
				a.depotId,
				a.receiptId receiptId,
				a.checkInDate,
				a.checkInDate sortDate,
				a.stockinType,
				'0' stockoutType,
				IFNULL('', '060') requisitionType,
				a.materialId,
				a.materialName,
				a.unit,
				a.quantity,
				b.price,
				format(	( ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 ), 6 ) newPrice,
				format( ( ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull( REPLACE (a.quantity, ',', ''), 0)),2) total
			FROM
				v_purchasestockindetail a
			LEFT JOIN v_purchaseorderdetail b ON a.contractId = b.contractId
			AND a.materialId = b.materialId
			AND b.deleteFlag = '0'
			WHERE
				A.checkInDate &gt; '#0' AND A.checkInDate &lt; '#1' AND A.materialId = '#2'
			UNION
				SELECT
					'O' dataFlag,
					b.YSId YSId,
					'' contractId,
					'' supplierName,
					b.depotId,
					b.stockOutId receiptId,
					b.checkOutDate,
					b.checkOutDate sortDate,
					'0' stockinType,
					b.stockoutType,
					IFNULL(c.requisitionType, '060') requisitionType,
					b.materialId,
					b.materialName,
					b.unit,
					b.quantity,
					b.price,
					format((ifnull(REPLACE(b.price, ',', ''), 0) / 1.17),6) newPrice,
					format((ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull(REPLACE (b.quantity, ',', ''),
								0)),2) total
				FROM
					v_stockout b
				LEFT JOIN v_requisitiondetail c ON b.requisitionId = c.requisitionId AND b.materialId = c.materialId 	AND c.deleteFlag = '0'
				WHERE
					b.checkOutDate &gt; '#0' 	AND b.checkOutDate &lt; '#1' AND b.materialId = '#2'
			
			UNION
				SELECT
					'U' dataFlag,
					'库存盘点' YSId,
					'' contractId,
					'' supplierName,
					'***' depotId,
					'*** ' receiptId,
					DATE_FORMAT(b.createTime, '%Y-%m-%d') createTime,
					DATE_FORMAT(b.createTime, '%Y-%m-%d') sortDate,
					'0' stockinType,
					'' stockoutType,
					'' requisitionType,
					b.materialId,
					d.materialName,
					'' unit,
					b.quantity,
					b.price,
					format(
						(
							ifnull(REPLACE(b.price, ',', ''), 0) / 1.17
						),
						6
					) newPrice,
					format(
						(
							ifnull(REPLACE(b.price, ',', ''), 0) / 1.17 * ifnull(
								REPLACE (b.quantity, ',', ''),
								0
							)
						),
						2
					) total
				FROM
					b_inventoryhistory b
				LEFT JOIN b_pricereference c ON b.materialId = c.materialId 	AND c.deleteFlag = '0'
				LEFT JOIN b_material d ON b.materialId = d.materialId
				WHERE
					b.createTime &gt; '#0' 	AND b.createTime &lt; '#1' 	AND b.materialId = '#2'
 	    	) a
	    	</from>
	
    <orderby>sortDate</orderby>
  </query>
	<query>
		<pool></pool>    
    	<name value="financeReprotForMonthly" />
     	<where>
    	</where>
	  	<select>
	      <f name="a.materialId" alias="" ctype="" />
      	  <f name="a.materialName" alias="" ctype="" />
      	  <f name="a.unit" alias="" ctype="计量单位" />
	      <f name="a.MAPrice" alias="" ctype="" />
	      <f name="IFNULL(b.beginningQty,0)" alias="" ctype="" />
	      <f name="IFNULL(b.beginningPrice,0)" alias="" ctype="" />
	      <f name="c1.stockinQty" alias="" ctype="" />
	      <f name="c1.stockinPrice" alias="" ctype="" />
	      <f name="c1.stockinAmount" alias="" ctype="" />
	      <f name="d1.stockoutQty" alias="" ctype="" />
	      <f name="d1.stockoutPrice" alias="" ctype="" />
	      <f name="d1.stockoutAmount" alias="" ctype="" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
	    <from>b_material a LEFT JOIN  b_inventorymonthlyreport b ON  a.materialId=b.materialId AND b.monthly='#0' LEFT JOIN (SELECT c.materialId, FORMAT(IFNULL(SUM(REPLACE(c.quantity, ',', '')),0),2) stockinQty, FORMAT(IFNULL(SUM(REPLACE(c.stockinAmount, ',', '')),0),2) stockinAmount, FORMAT(IFNULL(SUM(c.stockinAmount) / SUM(REPLACE(c.quantity, ',', '')),0),6) stockinPrice FROM v_stockin_and_contract c WHERE c.checkInDate &gt;='#1' AND c.checkInDate &lt;= '#2' GROUP BY c.materialId ) AS c1 ON a.materialId=c1.materialId LEFT JOIN (SELECT d.materialId, FORMAT(IFNULL(SUM(REPLACE(d.quantity, ',', '')),0),2) stockoutQty ,FORMAT(IFNULL(SUM(REPLACE(d.stockoutAmount, ',', '')),0),2) stockoutAmount, FORMAT(IFNULL(SUM(d.stockoutAmount) / SUM(REPLACE(d.quantity, ',', '')),0),6) stockoutPrice FROM v_stockout d  WHERE d.deleteFlag = '0' AND d.checkOutDate &gt;='#1' AND d.checkOutDate &lt;= '#2' GROUP BY d.materialId ) AS d1 ON a.materialId=d1.materialId WHERE a.deleteFlag='0' AND LEFT(a.materialId,1) &lt;&gt; 'I'</from>
	    <groupby></groupby>
	    <having>c1.stockinQty > 0  OR	d1.stockoutQty > 0</having>	
	    <orderby>a.materialId</orderby>
  	</query>
	<query>
		<pool></pool>    
    	<name value="stockoutDetailGroupByYsid" />
     	<where>
        	<w name="a.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    	</where>
	  	<select>
	      <f name="a.YSId" alias="" ctype="" />
	      <f name="a.materialId" alias="" ctype="" />
      	  <f name="c.materialName" alias="" ctype="" />
      	  <f name="a.countQty" alias="" ctype="" />
      	  <f name="a.quantity" alias="" ctype="" />
      	  <f name="a.price" alias="outPrice" ctype="" />
      	  <f name="IFNULL(e.price,0)" alias="price" ctype="" />
      	 <!-- f name="IF (IFNULL(a.price, c.MAPrice) = '0',IFNULL(d.price,e.totalPrice),IFNULL(a.price, c.MAPrice))" alias="price" ctype=""  -->
      	  <f name="REPLACE(a.quantity,',','') * IFNULL(REPLACE(e.price,',',''),0)" alias="totalPrice" ctype="" />
      	  <f name="c.unit" alias="" ctype="计量单位" />
	      <f name="c.MAPrice" alias="" ctype="" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <!--<from>v_stockoutdetailgroup a LEFT JOIN v_purchaseplandetailgroup e ON a.YSId=e.YSId AND a.materialId=e.materialId LEFT JOIN b_material c ON a.materialId=c.materialid AND c.deleteFlag='0' LEFT JOIN (SELECT c.materialId, MAX(c.purchaseDate) purchaseDate,c.price FROM v_purchaseorderdetail c GROUP BY c.materialId ) d ON d.materialId=a.materialId  WHERE left(a.materialId,1) &lt;&gt; 'A' AND LEFT (a.materialId, 1) &lt;&gt; 'I' </from -->
	    <from>v_stockoutdetailgroup a LEFT JOIN v_purchaseplandetailgroup e ON a.YSId=e.YSId AND a.materialId=e.materialId LEFT JOIN b_material c ON a.materialId=c.materialid AND c.deleteFlag='0'  WHERE left(a.materialId,1) &lt;&gt; 'A' AND LEFT (a.materialId, 1) &lt;&gt; 'I' </from>
	    <groupby></groupby>
	    <having></having>	
	    <orderby>a.materialId</orderby>
  	</query>
  <query>
    <pool></pool>    
    <name value="costAccountingList" />
     <where>
        <w name="m.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	    <w name="m.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
      	<!--w name="m.checkInDate"   des="" reqName="startDate" dtype="ch" oper="&gt;"  lg="AND" bt="" /-->
        <!--w name="m.checkInDate"   des="" reqName="endDate"   dtype="ch" oper="&lt;"  lg="AND" bt="" /-->
        <w name="m.orderType"     des="" reqName="orderType" dtype="ch" oper="="  lg="AND" bt="" />
        <w name="m.team"     	  des="" reqName="team" 	 dtype="ch" oper="="  lg="AND" bt="" />
        <w name="m.groupFlag"     des="" reqName="groupFlag" dtype="ch" oper="="  lg="AND" bt="" />
</where>
  <select>
      <f name="m.YSId" alias="" ctype="" />
      <f name="m.ysidAlready" alias="" ctype="" />
      <f name="m.groupFlag" alias="" ctype="" />
      <f name="m.orderType" alias="" ctype="" />
      <f name="m.xiaoshou" alias="RMBPrice" ctype="" />
      <f name="m.receipt" alias="" ctype="" />
      <f name="IFNULL(if(ISNULL(m.ysidAlready),m.cost,m.costAlready),0)" alias="cost_view" ctype="" />
      <f name="IFNULL(if(ISNULL(m.ysidAlready),m.labolCost,m.labolCostAlready),0)" alias="labolCost_view" ctype="" />
      <f name="IFNULL(if(ISNULL(m.ysidAlready),m.materialCost,m.materialCostAlready),0)" alias="materialCost_view" ctype="" />
      <f name="m.exchange_rate" alias="" ctype="" />
      <f name="m.receipt" alias="" ctype="" />
      <f name="m.materialId" alias="productId" ctype="" />
      <f name="m.materialName" alias="productName" ctype="" />
      <f name="m.currency" alias="" ctype="" />
      <f name="m.tuishui" alias="rebate" ctype="" />
      <f name="IFNULL(if(ISNULL(m.ysidAlready),m.xiaoshou - m.cost - zengzhishui + tuishui + m.gengdan,m.profitAlready),0)" alias="profit_view" ctype="" />
      <f name="if(ISNULL(m.ysidAlready),CONCAT(IFNULL(CONVERT((m.xiaoshou - m.cost - zengzhishui + tuishui + m.gengdan) / xiaoshou * 100 ,DECIMAL(32,2)),0) , '%'),CONCAT(m.profitRateAlready,'%'))" alias="profitRate_view" ctype="" />
      <f name="m.deliveryDate" alias="" ctype="" />
      <f name="m.orderDate" alias="" ctype="" />
      <f name="m.totalPrice_org" alias=" orderTotalPrice" ctype="" />
      <f name="m.totalQuantity" alias="" ctype="" />
      <f name="IFNULL(REPLACE(m.completedQuantity,',',''),'0')" alias="stockinQty" ctype="" />
      <f name="m.storageDate" alias="checkInDate" ctype="" />
      <!--f name="IFNULL(a.storageFinish,'010')" alias="storageFinish" ctype="" /-->
      <f name="m.team" alias="" ctype="业务组" />
      <f name="m.shortName" alias="customerShort" ctype="" />
      <!--f name="IFNULL(d.costSum, '0')" alias="costAcounting" ctype="" /-->
      <f name="IFNULL(m.exchange_rate,'1')" alias="exchange_rate" ctype="" />
      <f name="REPLACE(m.quantity,',','')" alias="quantity" ctype="" />
      <f name="REPLACE(m.completedQuantity,',','')" alias="completedQuantity" ctype="" />
      <!--f name="f.costSum" alias="labolCost" ctype="" /-->
      <!--f name="g.cost" alias="orderDeduct" ctype="" /-->
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- from>( SELECT a.YSId, A.receipt,c.checkInDate, a.PIId, a.materialId, a.deliveryDate, a.totalPrice, a.quantity, a.totalQuantity, c.quantity stockinQty, c.storageFinish, a.team, b1.shortName, a.orderDate, a.materialId productId, a.materialName productName, a.currency, A.orderType, a.full_field FROM v_orderlist a LEFT JOIN b_Customer b1 ON b1.customerId = a.customerId AND b1.deleteFlag = '0' JOIN ( SELECT  a.YSId,  a.materialId,  a.depotId,  sum(REPLACE(a.quantity, ',', '')) AS quantity,  max(a.storageFinish) AS storageFinish,  max(a.checkInDate) AS checkInDate FROM  v_purchasestockindetail a JOIN ( SELECT a.YSId, a.materialId  FROM v_purchasestockindetail a  WHERE checkInDate &gt; '#1'  AND checkInDate &lt; '#2' AND a.stockintype='030'  GROUP BY a.YSId,a.materialId ) b ON a.ysid = b.ysid AND a.materialId = b.materialId AND a.stockintype='030'  GROUP BY  b.YSId,b.materialId ) c ON c.materialId = a.materialId AND c.YSId = a.YSId WHERE A.orderType = '010' AND a.orderDate&lt;'#2' HAVING stockinQty + 0 &gt;= quantity + 0  ) a  LEFT JOIN b_costbom b ON a.YSId = b.YSId AND b.deleteFlag = '0' LEFT JOIN (  SELECT a.YSId, SUM( IF (  IFNULL(b.quantity, 0) + 0 &gt; a.orderQty + 0,  b.quantity,  a.orderQty ) * a.price ) costSum  FROM ( SELECT  a.YSId,  a.materialId,  a.price, IF ( sum(a.unitQuantity) = 0, 1, sum(a.unitQuantity)  ) * REPLACE (c.totalQuantity, ',', '') AS orderQty FROM  b_purchaseplandetail a LEFT JOIN b_orderdetail c ON c.ysid = a.ysid AND (c.deleteFlag = '0') JOIN ( SELECT a.YSId  FROM b_purchasestockin a  WHERE checkInDate &gt; '#1' AND checkInDate &lt; '#2' AND a.stockintype='030'  AND a.deleteFlag='0'  GROUP BY a.ysid ) c1 ON c1.ysid = a.ysid WHERE  a.deleteFlag = '0'  GROUP BY  a.YSId, a.materialId ) a  LEFT JOIN v_stockoutdetailgroup b ON a.YSId = b.YSId AND a.materialId = b.materialId  WHERE LEFT (a.materialId, 1) &lt;&gt; 'H'  GROUP BY a.ysid ) d ON d.ysid = a.ysid  LEFT JOIN (  SELECT f2.YSId, SUM(IFNULL( f2.manufactureQty,0) * IFNULL(REPLACE(f2.price, ',', ''), 0)) costSum  FROM v_purchaseplandetailgroup f2, ( SELECT  f1.YSId FROM  b_purchasestockin f1 WHERE  f1.checkInDate &gt; '#2' AND f1.checkInDate &lt; '#2' AND f1.stockintype='030'  AND f1.deleteFlag='0' GROUP BY  f1.ysid  ) f3  WHERE LEFT (f2.materialId, 1) = 'H' AND f2.ysid = f3.ysid  GROUP BY f2.ysid ) f ON f.ysid = a.ysid  LEFT JOIN b_pricereference e ON e.materialId = a.materialId AND a.orderType = '020' LEFT JOIN v_orderexpanse_groupby_type g ON g.ysid = a.ysid AND g.type = 'D' LEFT JOIN t_exchange_rate c1 ON c1.rate_day = a.checkInDate AND c1.currency = a.currency WHERE  1 = 1</from -->
    <!-- from>( SELECT a.YSId, A.receipt,c.checkInDate, a.PIId, a.materialId, a.deliveryDate, a.totalPrice, a.quantity, a.totalQuantity, c.quantity stockinQty, c.storageFinish, a.team, b1.shortName, a.orderDate, a.materialId productId, a.materialName productName, a.currency, A.orderType, a.full_field FROM v_orderlist a LEFT JOIN b_Customer b1 ON b1.customerId = a.customerId AND b1.deleteFlag = '0' JOIN ( SELECT  a.YSId,  a.materialId,  a.depotId,  sum(REPLACE(a.quantity, ',', '')) AS quantity,  max(IFNULL(a.storageFinish,'010')) AS storageFinish,  max(a.checkInDate) AS checkInDate FROM  v_purchasestockindetail a JOIN ( SELECT a.YSId, a.materialId  FROM v_purchasestockindetail a  WHERE a.stockintype='030' #1    GROUP BY a.YSId,a.materialId ) b ON a.ysid = b.ysid AND a.materialId = b.materialId AND a.stockintype='030'  GROUP BY  b.YSId,b.materialId ) c ON c.materialId = a.materialId AND c.YSId = a.YSId WHERE A.orderType = '010' #2 HAVING #3  ) a  LEFT JOIN b_costbom b ON a.YSId = b.YSId AND b.deleteFlag = '0' LEFT JOIN (  SELECT a.YSId, SUM( IF (  IFNULL(b.quantity, 0) + 0 &gt; a.orderQty + 0,  b.quantity,  a.orderQty ) * a.price ) costSum  FROM ( SELECT  a.YSId,  a.materialId,  a.price, IF ( sum(a.unitQuantity) = 0, 1, sum(a.unitQuantity)  ) * REPLACE (c.totalQuantity, ',', '') AS orderQty FROM  b_purchaseplandetail a LEFT JOIN b_orderdetail c ON c.ysid = a.ysid AND (c.deleteFlag = '0') JOIN ( SELECT a.YSId  FROM b_purchasestockin a  WHERE a.stockintype='030' #1   AND a.deleteFlag='0'  GROUP BY a.ysid ) c1 ON c1.ysid = a.ysid WHERE  a.deleteFlag = '0'  GROUP BY  a.YSId, a.materialId ) a  LEFT JOIN v_stockoutdetailgroup b ON a.YSId = b.YSId AND a.materialId = b.materialId  WHERE LEFT (a.materialId, 1) &lt;&gt; 'H'  GROUP BY a.ysid ) d ON d.ysid = a.ysid  LEFT JOIN (  SELECT f2.YSId, SUM(IFNULL( f2.manufactureQty,0) * IFNULL(REPLACE(f2.price, ',', ''), 0)) costSum  FROM v_purchaseplandetailgroup f2, ( SELECT  f1.YSId FROM  b_purchasestockin f1 WHERE  f1.stockintype='030' #1  AND f1.deleteFlag='0' GROUP BY  f1.ysid  ) f3  WHERE LEFT (f2.materialId, 1) = 'H' AND f2.ysid = f3.ysid  GROUP BY f2.ysid ) f ON f.ysid = a.ysid  LEFT JOIN b_pricereference e ON e.materialId = a.materialId AND a.orderType = '020' LEFT JOIN v_orderexpanse_groupby_type g ON g.ysid = a.ysid AND g.type = 'D' LEFT JOIN t_exchange_rate c1 ON c1.rate_day = a.checkInDate AND c1.currency = a.currency WHERE  1 = 1</from -->
    <from>#1 m</from>
    <orderby>m.ysid </orderby>
    <groupby></groupby>
    <having>#2</having>
	<power></power>    
  </query>
	<query>
		<pool></pool>    
    	<name value="costAccountingGroupByYear" />
     	<where>
        	<w name="m.team"       des="" reqName="team"     dtype="ch" oper="="  lg="AND" bt="" />
        	<w name="m.yearFlag"   des="" reqName="yearFlag" dtype="ch" oper="="  lg="AND" bt="" />
    	</where>
	  	<select>
	      <f name="m.groupFlag" alias="" ctype="" />
	      <f name="FORMAT(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.cost,	m.costAlready),0),',','')),2)" alias="cost_group" ctype="" />
	      <f name="FORMAT(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.labolCost,	m.labolCostAlready),0),',','')),2)" alias="labol_group" ctype="" />
	      <f name="FORMAT(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.materialCost,	m.materialCostAlready),0),',','')),2)" alias="materail_group" ctype="" />
	      <f name="FORMAT(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.xiaoshou - m.cost - zengzhishui + tuishui + m.gengdan,	m.profitAlready),0),',','')),2)" alias="profit_group" ctype="" />
	      <f name="FORMAT(sum(REPLACE(IFNULL(m.xiaoshou,0),',','')),2)" alias="xiaoshou_group" ctype="" />
	      <f name="ROUND(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.xiaoshou - m.cost - zengzhishui + tuishui + m.gengdan,	m.profitAlready),0),',','')) / sum(REPLACE(IFNULL(m.xiaoshou,0),',',''))*100,2)" alias="profit_rate" ctype="" />
	      <f name="ROUND(sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.xiaoshou - m.cost - zengzhishui + tuishui + m.gengdan,	m.profitAlready),0),',','')) / sum(REPLACE(IFNULL(IF (	ISNULL(m.ysidAlready),	m.cost,	m.costAlready),0),',','')) * 100,2) " alias="profit_rate_old" ctype="" />

	  	</select>
	    <from>v_costAccounting_m m WHERE m.receipt &lt;&gt; 'F' AND m.orderType = '010' </from>
	    <groupby>m.groupFlag</groupby>
	    <having></having>	
	    <orderby>m.groupFlag</orderby>
  	</query>
  <query>
    <pool></pool>    
    <name value="costBomDetailByYsid" />
     <where>
        <w name="A.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.bomId" alias="" ctype="" />
      <f name="a.cost" alias="" ctype="" />
      <f name="a.accountingDate" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="c.materialName" alias="" ctype="" />
      <f name="c.unit" alias="" ctype="计量单位" />
      <f name="a.currency" alias="" ctype="" />
      <f name="a.exchangeRate" alias="" ctype="" />
      <f name="a.rebate" alias="" ctype="" />
      <f name="a.rebateRate" alias="" ctype="" />
      <f name="a.profit" alias="" ctype="" />
      <f name="a.price" alias="" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.vat" alias="" ctype="" />
      <f name="a.RMBPrice" alias="" ctype="" />
      <f name="a.profitRate" alias="" ctype="" />
      <f name="a.materialCost" alias="" ctype="" />
      <f name="a.labolCost" alias="" ctype="" />
      <f name="a.actualSales" alias="" ctype="" />
      <f name="a.gross" alias="" ctype="" />
      <f name="a.deduct" alias="" ctype="" />
      <f name="IFNULL(a.discount,0)" alias="discount" ctype="" />
      <f name="IFNULL(a.commission,0)" alias="commission" ctype="" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="if(e.unitQuantity=0,1,e.unitQuantity)" alias="unitQuantity" ctype="" />
      <f name="e.orderQty" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>v_costbomdetail a LEFT JOIN v_purchaseplandetailgroup e ON e.YSId=a.YSId AND e.materialId=a.materialId left join v_orderlist b on a.ysid=b.ysid LEFT JOIN b_material c ON c.materialId=a.materialId</from>
    <orderby>a.materialId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getBaseBomCostByYsid" />
     <where>
        <w name="A.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="b.materialId" alias="productId" ctype="" />
      <f name="SUM(REPLACE(a.totalQuantity,',','') * REPLACE(b.price,',','') * REPLACE(b.quantity,',',''))" alias="cost" ctype="" />
      <f name="SUM(IF(LEFT(b.materialId,1) = 'H',REPLACE(a.totalQuantity,',','') * REPLACE(b.price,',','') * REPLACE(b.quantity,',',''),0))" alias="labolCost" ctype="" />
      <f name="SUM(IF(LEFT(b.materialId,1) &lt;&gt; 'H',REPLACE(a.totalQuantity,',','') * REPLACE(b.price,',','') * REPLACE(b.quantity,',',''),0))" alias="materCost" ctype="" />

  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>b_orderdetail a  LEFT JOIN v_basebomdetail b ON a.materialId=b.productId </from>
    <orderby></orderby>
    <groupby>a.YSId</groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getLabolCostByYsid" />
     <where>
        <w name="A.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="format(sum(REPLACE(a.price,',','') * REPLACE(a.manufactureQuantity,',','')),2)" alias="labolCost" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>b_purchaseplandetail a WHERE LEFT(a.materialId,1)='H'</from>
    <orderby></orderby>
    <groupby>a.YSId</groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="checkStockOutById" />
     <where>
        <w name="e.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="e.YSId" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from> v_stockout e WHERE 	LEFT (e.materialId, 1) &lt;&gt; 'A' AND LEFT (e.materialId, 1) &lt;&gt; 'I' </from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
	<query>
		<pool></pool>    
    	<name value="planBomDetailById" />
     	<where>
        	<w name="a.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    	</where>
	  	<select>
	      <f name="a.YSId" alias="" ctype="" />
	      <f name="a.materialId" alias="" ctype="" />
      	  <f name="c.materialName" alias="" ctype="" />
      	  <f name="IFNULL(b.countQty,'0')" alias="countQty" ctype="" />
      	  <f name="a.manufactureQuantity" alias="orderQty" ctype="" />
      	  <f name="IFNULL(b.quantity,'0')" alias="stockoutQty" ctype="" />
      	  <f name="IFNULL(a.price,0)" alias="price" ctype="" />
      	  <f name="IFNULL(REPLACE(IFNULL(b.quantity,a.manufactureQuantity), ',', ''),0) * IFNULL(REPLACE(a.price, ',', ''), 0)" alias="totalPrice" ctype="" />
      	  <f name="c.unit" alias="" ctype="计量单位" />
	      <f name="c.MAPrice" alias="" ctype="" />
	      <f name="a.unitQuantity" alias="" ctype="" />
	      <f name="d.totalQuantity" alias="" ctype="" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <from>v_purchaseplandetailgroup  a LEFT JOIN b_orderdetail d ON a.YSId = d.YSId AND d.deleteFlag='0' LEFT JOIN v_stockoutdetailgroup b ON a.YSId=b.YSId AND a.materialId=b.materialId LEFT JOIN b_material c ON a.materialId=c.materialid AND c.deleteFlag='0'   </from>
	    <groupby></groupby>
	    <having></having>	
	    <orderby>a.materialId</orderby>
  	</query>
  <query>
    <pool></pool>     
    <name value="getOrderList" />
    <where>
   	  <w name="A.YSId"       des=""  reqName="YSId"      dtype="ch" oper="="  lg="AND" bt="" />
   	</where>
    <select>
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.PIId" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.totalprice" alias="" ctype="" />
      <f name="A.totalQuantity" alias="" ctype="" />
      <f name="A.fullName" alias="customerFullName" ctype="" />
      <f name="A.customerId" alias="" ctype="" />
      <f name="A.shortName" alias="" ctype="" />
      <f name="A.checkInDate" alias="" ctype="" />
      <f name="IFNULL(A.rebate,'0')" alias="discount" ctype="" />
      <f name="IFNULL(A.commission,'0')" alias="commission" ctype="" />
      <f name="b.exchange_rate" alias="" ctype="" />
      <f name="A.currency" alias="" ctype="币种" />
      <f name="A.currency" alias="currencyId" ctype="" />
      <f name="b.rate_day" alias="" ctype="" />
      <f name="a.team" alias="" ctype="业务组" />
    </select>
    <from>v_stockin_for_product AS A LEFT JOIN t_exchange_rate b ON a.currency = b.currency AND a.checkInDate=b.rate_day </from>
    <orderby>left(A.YSId,8) DESC,mid(A.YSId,LOCATE('-',A.YSId)+1,2)+0</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>  
  </query>
  <query>
		<pool></pool>    
    	<name value="orderDetailPeiForCostAccouting" />
     	<where>
        	<w name="a.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    	</where>
	  	<select>
	      <f name="a.YSId" alias="" ctype="" />
	      <f name="a.materialId" alias="" ctype="" />
	      <f name="a.materialName" alias="" ctype="" />
      	  <f name="a.totalQuantity" alias="orderQty" ctype="" />
      	  <f name="IFNULL(c.quantity,'0')" alias="stockoutQty" ctype="" />
      	  <f name="IFNULL(e.lastPrice,0)" alias="lastPrice" ctype="" />
      	  <f name="IFNULL(ff.price,0)" alias="contractPrice" ctype="" />
      	  <f name="IFNULL(c.countQty,0)" alias="countQty" ctype="" />
      	  <f name="a.unit" alias="" ctype="计量单位" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <from>v_orderdetail a LEFT JOIN b_costbom b ON a.YSId=b.YSId AND b.deleteFlag='0' LEFT JOIN v_stockoutdetailgroup c ON a.YSId=c.YSId AND a.materialId=c.materialId   LEFT JOIN b_pricereference e ON e.materialId = a.materialId  LEFT JOIN (select f1.price,f1.materialId,f1.createTime  FROM v_purchaseorderdetail f1 , (SELECT g.createTime,g.materialId FROM  v_contract_createtime_max g) f WHERE f.createTime = f1.createTime AND f.materialId = f1.materialId ) ff ON  ff.materialId = a.materialId WHERE a.orderType='020'  </from>
	    <groupby></groupby>
	    <having></having>	
	    <orderby>a.materialId</orderby>
  	</query>
    <query>
		<pool></pool>    
    	<name value="orderProcessByYsid" />
     	<where>
        	<w name="a.YSId"   des="" reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
        	<w name="a.type"   des="" reqName="type" dtype="ch" oper="="  lg="AND" bt="" />
    	</where>
	  	<select>
	      <f name="a.YSId" alias="" ctype="" />
	      <f name="a.cost" alias="" ctype="" />
	      <f name="a.type" alias="" ctype="" />
	  	</select>
	    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
	    <from>v_orderexpanse_groupby_type a  </from>
	    <groupby></groupby>
	    <having></having>	
	    <orderby></orderby>
  	</query>
  <query>
    <pool></pool>    
    <name value="orderListForReceivabel" />
     <where>
        <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	    <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
        <w name="b.receivableId" des=""  reqName="receivableId"     dtype="ch" oper="="     lg="AND" bt="" />
        <w name="a.YSId"         des=""  reqName="YSId"             dtype="ch" oper="="     lg="AND" bt="" />
        <w name="a.YSId"         des=""  reqName="ysids"            dtype="ch" oper="in"    lg="AND" bt="" />
        <w name="date_add(c.checkInDate,INTERVAL a.paymentTerm DAY)"   des="" reqName="reserveDate" dtype="ch" oper="&lt;"  lg="AND" bt="" />
</where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.currency" alias="" ctype="币种" />
      <f name="A.currency" alias="currencyId" ctype="" />
      <f name="IFNULL(b.receivableId,'')" alias="receivableId" ctype="" />
      <f name="IFNULL(b.actualAmountCnt,'0')" alias="actualAndBankCnt" ctype="" />
      <f name="IFNULL(b.actualAmount,'0')" alias="actualAmountCnt" ctype="" />
      <f name="IFNULL(b.bankDeduction,'0')" alias="bankDeductionCnt" ctype="" />
      <f name="IFNULL(b.bankDeduction,0) + IFNULL(b.actualAmount,0)" alias="actualCnt" ctype="" />
      <f name="REPLACE(a.totalPrice,',','') - IFNULL(b.bankDeduction,0) - IFNULL(b.actualAmount,'0')" alias="surplus" ctype="" />
      <f name="IFNULL(a.completedQuantity,'')" alias="stockinQty" ctype="" />
      <f name="a.materialId" alias="productId" ctype="" />
      <f name="a.materialName" alias="productName" ctype="" />
      <f name="a.storageDate" alias="checkInDate" ctype="" />
      <f name="b.collectionDate" alias="" ctype="" />
      <f name="IFNULL(b.status,'010')" alias="status" ctype="收款状态" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.totalQuantity" alias="" ctype="" />
      <f name="REPLACE(a.quantity, ',', '') * right(a.price,LENGTH(a.price)-2)" alias="orderPrice" ctype="" />
      <f name="a.totalPrice" alias="" ctype="" />
      <f name="a.paymentTerm" alias="" ctype="" />
      <f name="a.customerFullName" alias="" ctype="" />
      <f name="a.customerId" alias="" ctype="" />
      <f name="date_add(ifNULL(a.storageDate,a.deliveryDate), interval IFNULL(a.paymentTerm,60) day)" alias="reserveDate" ctype="" />
  </select>
    <from>
    	v_orderlist a 
    		LEFT JOIN (SELECT IFNULL(c2.YSId,c.YSId) YSId,c.receivableId,c.status,c1.actualAmountCnt,
    					c1.actualAmount,c1.bankDeduction,c1.customerDeduction ,
    					c1.collectionDate 
    				   FROM b_receivable c,v_receivabledetailgroup c1 ,b_receivableorder c2
    				   WHERE  c.deleteFlag='0' AND c.receivableId=c1.receivableId AND c.receivableId=c2.receivableId
    			)b ON a.YSId=b.YSId 
    	WHERE a.payment is NULL 
    </from>
    <orderby>a.ysid </orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>
  
  <query>
    <pool></pool>    
    <name value="receivableDetailById" />
     <where>
        <w name="a.receivableId"       des=""  reqName="receivableId"     dtype="ch" oper="="     lg="AND" bt="" />
        <w name="b.receivableSerialId" des=""  reqName="receivableSerialId" dtype="ch" oper="=" lg="AND" bt="" />
 </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.currency" alias="" ctype="币种" />
      <f name="A.currency" alias="currencyId" ctype="" />
      <f name="IFNULL(a.receivableId,'')" alias="receivableId" ctype="" />
      <f name="IFNULL(b.actualAmount,'0')" alias="actualAmount" ctype="" />
      <f name="IFNULL(b.bankDeduction,'0')" alias="bankDeduction" ctype="" />
      <f name="IFNULL(b.customerDeduction,'0')" alias="customerDeduction" ctype="" />
      <f name="b.receivableSerialId" alias="" ctype="" />
      <f name="b.collectionDate" alias="" ctype="" />
      <f name="IFNULL(a.status,'010')" alias="status" ctype="收款状态" />
      <f name="a.amountReceivable" alias="" ctype="" />
      <f name="a.customerId" alias="" ctype="" />
      <f name="b.remarks" alias="" ctype="" />
      <f name="c.LoginName" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>b_receivable a,b_receivabledetail b 
    	  LEFT JOIN s_user c ON c.UserID = b.payee 
    	where a.receivableId=b.receivableId and a.deleteFlag='0' and b.deleteFlag='0' </from>
    <orderby>b.receivableSerialId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getMAXReceivableId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <from>b_Receivable a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query> 
  <query>
    <pool></pool>    
    <name value="getMAXReceivableDetailId" />
     <where>
       <w name="A.receivableId" des=""  reqName="receivableId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <from>b_ReceivableDetail a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>  
  <query>
    <pool></pool>    
    <name value="getReceivableCountById" />
     <where>
       <w name="A.receivableId" des=""  reqName="receivableId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" receivableId" alias="" ctype="" />
      <f name=" actualAmount" alias="" ctype="" />
      <f name=" bankDeduction" alias="" ctype="" />
      <f name=" actualAmount + bankDeduction" alias="actualAmountCnt" ctype="" />
      <f name=" customerDeduction" alias="" ctype="" />
      <f name=" collectionDate" alias="" ctype="" />
  </select>
    <from>v_receivabledetailgroup a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>   
  <query>
    <pool></pool>    
    <name value="getStorageValueFromMonth" />
     <where>
       <w name="LEFT(b.beginningDate,7)" des=""  reqName="beginningDate" dtype="ch" oper="="  lg="AND" bt="" />
       <w name="a.materialId"            des=""  reqName="materialId"    dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.materialId" alias="" ctype="" />
      <f name="b.beginningDate" alias="" ctype="" />
      <f name="b.beginningWaitIn" alias="" ctype="" />
      <f name="b.beginningWaitOut" alias="" ctype="" />
      <f name="b.beginningAvailabel" alias="" ctype="" />
      <f name="b.beginningInventory" alias="" ctype="" />
      <f name="b.beginningPrice" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
  </select>
    <from>b_material a  LEFT JOIN b_InventoryManagemen b ON a.materialId=b.materialId</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query> 
  <query>
    <pool></pool>    
    <name value="getStorageValueByMonthly" />
     <where>
       <w name="a.materialId"            des=""  reqName="materialId"    dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.materialId" alias="" ctype="" />
      <f name="IFNULL(a.beginningDate,'#0')" alias="startDate" ctype="" />
      <f name="a.beginningInventory" alias="startValue" ctype="" />
      <f name="IFNULL(b.beginningDate,'#1')" alias="endDate" ctype="" />
      <f name="IFNULL(b.beginningInventory,'***')" alias="endValue" ctype="" />
  </select>
    <from>
	(
		SELECT
			date_format(a.beginningDate ,'%Y-%m-%d') beginningDate,
			a.materialId,
			a.beginningInventory
		FROM b_inventorymanagemen a
		WHERE  date_format(a.beginningDate ,'%Y-%m-%d') = '#0'
	) a 
		LEFT JOIN
	(
		SELECT
			date_format(a.beginningDate ,'%Y-%m-%d') beginningDate,
			a.materialId,
			a.beginningInventory
		FROM b_inventorymanagemen a
		WHERE  date_format(a.beginningDate ,'%Y-%m-%d') = '#1'
	) b
		ON a.materialId = b.materialId
		WHERE 1=1
	</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>    
  <query>
    <pool></pool>    
    <name value="getPaymentDetailByContractId" />
     <where>
    </where>
  <select>
      <f name="e.paymentHistoryId" alias="" ctype="" />
      <f name="e.paymentId" alias="" ctype="" />
      <f name="e.paymentAmount" alias="" ctype="" />
      <f name="e.finishDate" alias="" ctype="" />
      <f name="d.contractId" alias="" ctype="" />
  </select>
    <from>
		b_paymenthistory e, 
		(
			SELECT
			b.paymentId,
			group_concat(b.contractId SEPARATOR ','	) AS contractId
			FROM b_paymentdetail b,
			(
				SELECT a.paymentId,a.contractId
				FROM b_paymentdetail a
				WHERE a.contractId='#0' AND a.deleteFlag='0'
			) c
			WHERE c.paymentId=b.paymentId AND b.deleteFlag='0'
		) d 
		WHERE d.paymentId=e.paymentId  AND e.deleteFlag='0'
	</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>    
  <query>
    <pool></pool>    
    <name value="orderListForReceivabelById" />
     <where>
    </where>
  <select>
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.materialId" alias="productId" ctype="" />
      <f name="b.materialName" alias="productName" ctype="" />
      <f name="b.totalPrice" alias="" ctype="" />
      <f name="b.customerFullName" alias="" ctype="" />
      <f name="b.currency" alias="" ctype="" />
  </select>
    <from>
		 v_orderlist b
		JOIN
			(
				SELECT
				a.ysid
				FROM b_ReceivableOrder a
				WHERE a.receivableId='#' AND a.deleteFlag='0' 
			) b1 ON b.YSId=b1.ysid
	</from>
    <orderby>b.YSId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
</root>