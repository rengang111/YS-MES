<?xml version="1.0" encoding="UTF-8"?>
<root>
  <query>
    <pool></pool>    
    <name value="getRequisitionById" />
     <where>
       <w name="A.YSId" des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
       <w name="A.requisitionId"   des=""  reqName="requisitionId"   dtype="ch" oper="="  lg="AND" bt="" />
       <w name="A.requisitionType" des=""  reqName="requisitionType" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="A.collectYsid" alias="" ctype="" />
      <f name="a.storeUserId" alias="" ctype="" />
      <f name="a.requisitionUserId" alias="" ctype="" />
      <f name="a.requisitionSts" alias="" ctype="料件出库状态" />
      <f name="a.requisitionSts" alias="requisitionStsId" ctype="" />
      <f name="b.loginName" alias="storeUser" ctype="" />  
      <f name="c.loginName" alias="requisitionUser" ctype="" />
      <f name="a.virtualClass" alias="" ctype="" />
      <f name="a.deleteFlag" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_requisition a LEFT JOIN s_user b ON a.storeUserId=b.UserID AND b.deleteFlag='0' LEFT JOIN s_user c ON a.requisitionUserId=c.UserID AND c.deleteFlag='0'  where a.deleteFlag='0'</from>
    <orderby>a.requisitionId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getPurchasePlanByYSId" />
    <where>
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.manufactureQuantity" alias="" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="a.totalRequisition" alias="" ctype="" />
      <f name="a.requistionQty" alias="" ctype="" />
      <f name="a.unitQuantity" alias="" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="a.purchaseType" alias="purchaseTypeName" ctype="物料采购类别" />
      <f name="a.purchaseType" alias="" ctype="" />
      <f name="a.subBomNo" alias="" ctype="" />
      <f name="b.areaNumber" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>
		(
			SELECT
				a.YSId AS YSId,
				a.materialId AS materialId,
				c.materialName AS materialName,
				c.unit AS unit,
				a.unitQuantity AS unitQuantity,
				a.purchaseQuantity,
				a.requisitionType,
				a.supplierId AS supplierId,
				REPLACE(IFNULL(a.totalRequisition,a.manufactureQuantity),',','') AS totalRequisition,
				a.manufactureQuantity AS manufactureQuantity,
				c.quantityOnHand AS quantityOnHand,
				c.availabelToPromise AS availabelToPromise,
				c.purchaseType AS purchaseType,
				ifnull(d.quantity, '0') AS requistionQty,
				a.deleteFlag AS deleteFlag,
				a.subBomNo AS subBomNo,
				a.recordId AS recordId
			FROM
			v_purchaseplan a
				LEFT JOIN b_material c ON  a.materialId = c.materialId AND (c.deleteFlag = '0')  
			  	LEFT JOIN 
					(
						SELECT
							b.YSId AS YSId,
							b.YSId AS requistionYsid,
							a.materialId AS materialId,
							IFNULL(b.collectYsid,b.YSId) collectYsid,
							MAX(b.requisitionDate) requisitionDate,
							sum(REPLACE(ifnull(a.quantity, 0),',','')) AS quantity
						FROM
								b_requisitiondetail a
								JOIN b_requisition b ON a.requisitionId = b.requisitionId AND b.deleteFlag='0'
						WHERE	a.deleteFlag = '0' AND b.YSId = '#'
						GROUP BY
							b.YSId,
							a.materialId 
					) d ON a.materialId = d.materialId AND (d.YSId = a.YSId)				
			WHERE LEFT (a.materialId, 1) &lt;&gt; 'H' AND a.YSId='#'
			having totalRequisition+0 >0
		) AS A 
		LEFT JOIN 
			(
			SELECT
				c.materialId,
				c.ysid,
				SUM(REPLACE(c.quantity, ',', '')) quantity,
				max(c.checkInDate) AS checkInDate,
				max(c.storageFinish) storageFinish,
				group_concat( c.areaNumber SEPARATOR ',' ) AS areaNumber
			FROM
				v_purchasestockindetail c
			WHERE
				c.deleteFlag = '0' AND c.YSId='#'
			GROUP BY
				c.ysid,
				c.materialId 
			) b ON b.YSId=a.YSId AND b.materialId=a.materialId  
		WHERE  A.deleteFlag = '0'</from>
  
    <groupby></groupby>
    <having></having>
    <!--
    <union>
	    <where>
    		<w name="b.YSId" des="" reqName="YSId" dtype="ch" oper="=" lg="AND" bt="" />
	    </where>	    
	    <select>
	      <f name="''" alias="recordId" ctype="" />
	      <f name="c.YSId" alias="YSId" ctype="" />
	      <f name="b.rawMaterialId" alias="materialId" ctype="" />
	      <f name="b.materialName" alias="" ctype="" />
	      <f name="''" alias="contractId" ctype="" />
	      <f name="''" alias="supplierId" ctype="" />
	      <f name="b.totalQuantity" alias="manufactureQuantity" ctype="" />
	      <f name="''" alias="contractStorage" ctype="" />
	      <f name="quantityOnHand" alias="" ctype="" />
	      <f name="b.availabelToPromise" alias="" ctype="" />
	      <f name="IFNULL(c.quantity,'0.00')" alias="totalRequisition" ctype="" />
	      <f name="'-'" alias="unitQuantity" ctype="" />
	      <f name="b.unit" alias="" ctype="计量单位" />
	      <f name="''" alias="contractMaterialId" ctype="" />
	      <f name="'原材料'" alias="purchaseTypeName" ctype="物料采购类别" />
	      <f name="'040'" alias="purchaseType" ctype="" />
      	  <f name="''" alias="areaNumber" ctype="" />
	    </select>
	    <from>v_purchaseplandetailzz b LEFT JOIN v_requisitiondetailgroup c ON b.rawMaterialId=c.materialId AND b.YSId=c.YSId AND c.deleteFlag='0' where</from>	
	    <groupby></groupby>
	    <having></having>
    </union>
    -->
    <orderby>materialId</orderby>
	<power></power>    
  </query>
  
  <query>
    <pool></pool>    
    <name value="getPartsOrderDetailByYSId" />
    <where>
    	<w name="A.peiYsid" des="" reqName="peiYsid" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.PIId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.totalQuantity" alias="manufactureQuantity" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="ifnull(d.quantity,'0')" alias="totalRequisition" ctype="" />
      <f name="'1'" alias="unitQuantity" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="a.purchaseType" alias="purchaseTypeName" ctype="物料采购类别" />
      <f name="a.purchaseType" alias="" ctype="" />
      <f name="a.peiYsid" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_orderdetail AS A 
	   	--	LEFT JOIN v_purchasestockindetailgroup b ON b.YSId = a.peiYsid AND b.materialId = a.materialId AND b.deleteFlag='0' 
	   	--	LEFT JOIN v_purchaseorderdetail c ON a.YSId=c.YSId AND c.materialId=a.materialId AND c.deleteFlag='0' 
	   		LEFT JOIN v_requisitiondetailgroup d ON  a.materialId = d.materialId AND d.YSId = a.peiYsid  
   		WHERE  A.deleteFlag = '0'</from>
    <groupby></groupby>
    <having>REPLACE(totalRequisition,',','')+0 &lt;= 0</having>
    <orderby>mid(A.YSId,LOCATE('-', A.YSId) + 1,2) + 0</orderby>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getMAXRequisitionId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_requisition a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  
  <query>
    <pool></pool>    
    <name value="getMAXTaskId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name=" IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_ProductionTask a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="getRequisitionDetailById" />
     <where>
        <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
        <w name="A.recordId" des=""  reqName="recordId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.detailRecordId" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.purchaseType" alias="" ctype="物料采购类别" />
      <f name="a.remarks" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.requisitionSts" alias="" ctype="料件出库状态" />
      <f name="a.usedType" alias="" ctype="单独领料用途" />
      <f name="a.usedType" alias="usedTypeId" ctype="" />
      <f name="format(replace(a.quantity,',',''),2)" alias="quantity" ctype="" />
      <f name="IFNULL(a.overQuantity,0)" alias="overQuantity" ctype="" />
      <f name="a.deleteFlag" alias="" ctype="" />
      <f name="IFNULL(a.contractId,'-')" alias="contractId" ctype="" />
      <f name="IFNULL(a.supplierId,'-')" alias="supplierId" ctype="" />
      <f name="c.loginName" alias="requisitionUser" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_requisitionDetail a LEFT JOIN s_user c ON a.requisitionUserId=c.UserID AND c.deleteFlag='0'  where a.deleteFlag='0'</from>
    <orderby>a.materialId </orderby>
    <groupby></groupby>
    <having></having>
	<power>
	</power>    
  </query>
  <query>
    <pool></pool>    
    <name value="updateRequisition" />
    <where>
        <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.detailRecordId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="c.manufactureQuantity" alias="" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="c.totalRequisition" alias="" ctype="" />
      <f name="c.unitQuantity" alias="" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="c.materialId" alias="contractMaterialId" ctype="" />
      <f name="a.purchaseType" alias="" ctype="物料采购类别" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.overQuantity" alias="" ctype="" />
      <f name="a.scrapQuantity" alias="" ctype="" />
      <f name="a.excessType" alias="excessTypeId" ctype="" />
      <f name="a.excessType" alias="" ctype="超领区分" />
      <f name="a.virtualClass" alias="" ctype="虚拟领料区分" />
      <f name="IFNULL(a.subBomNo,'0')" alias="subBomNo" ctype="" />
      <f name="a.remarks" alias="" ctype="" />
      <f name="d.LoginName" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_requisitiondetail  AS A LEFT JOIN s_user d ON a.requisitionUserId=d.UserId LEFT JOIN  b_purchaseplandetail c ON a.ysid = c.ysid AND  c.materialId = a.materialId AND c.subBomNo = IFNULL(a.subBomNo,0) AND c.deleteFlag = '0' WHERE  A.deleteFlag = '0'</from>
    <orderby>A.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getPurchasePlanDetailGroup" />
    <where>
    	<w name="A.YSId" des="" reqName="YSId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.manufactureQuantity" alias="" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="a.unitQuantity" alias="" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="a.purchaseType" alias="" ctype="物料采购类别" />
      <f name="IFNULL(b.quantity,0)" alias="quantity" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_purchaseplandetailgroup AS A LEFT JOIN v_workshopreturngroup b ON b.YSId=a.YSId AND b.materialId=a.materialId WHERE  A.deleteFlag = '0' AND a.supplierId != '0574YZ00' AND left(a.materialId,1) != 'H' AND a.purchaseType = '010'  </from>
    <orderby>A.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getWorkshopReturnList" />
    <where>
    	<w name="a.YSId" des="" reqName="YSId" dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="a.workshopReturnId" des="" reqName="workshopReturnId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.workshopReturnId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.returnDate" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.unit" alias="" ctype="计量单位" />
      <f name="b.recordId" alias="materialRecordId" ctype="" />
      <f name="b.parentId" alias="materialParentId" ctype="" />
      <f name="a.taskId" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
   <from>b_workshopreturn a LEFT JOIN b_material b ON b.materialId = a.materialId AND b.deleteFlag = '0' where a.deleteFlag='0'</from>
    <orderby>a.workshopReturnId DESC,a.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  
  <query>
    <pool></pool>    
    <name value="getRawMaterialList" />
    <where>
    	<w name="b.YSId" des="" reqName="YSId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
	      <f name="b.rawMaterialId" alias="materialId" ctype="" />
	      <f name="b.materialId" alias="parentMaterialId" ctype="" />
	      <f name="b.materialName" alias="" ctype="" />
	      <f name="SUM(REPLACE(b.purchaseQuantity,',',''))" alias="purchaseQuantity" ctype="" />
	      <f name="b.quantityOnHand" alias="" ctype="" />
	      <f name="b.availabelToPromise" alias="" ctype="" />
	      <f name="IFNULL(c.quantity,'0')" alias="totalRequisition" ctype="" />
	      <f name="IFNULL(d.quantity,'0')" alias="requisitionQty" ctype="" />
	      <f name="b.unit" alias="" ctype="计量单位" />
	      <f name="b.unit" alias="unitId" ctype="" />
	      <f name="b.zzunit" alias="" ctype="计量单位" />
	      <f name="b.zzunit" alias="zzunitId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
   <from>v_purchaseplandetailzz b LEFT JOIN v_stockoutdetailgroup c ON b.rawMaterialId = c.materialId AND c.YSId=b.YSId  LEFT JOIN v_requisitiondetailgroup d ON b.rawMaterialId=d.materialId AND d.YSId = b.YSId </from>
    <orderby>b.rawMaterialId</orderby>
    <groupby>b.rawMaterialId</groupby>
    <having>cast(purchaseQuantity AS DECIMAL (10, 0)) > 0</having>
	<power></power>    
  </query>
   <query>
    <pool></pool>    
    <name value="getRawRequirementById" />
    <where>
    	<w name="b.YSId"    des="" reqName="YSId"    dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="b.rawType" des="" reqName="rawType" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
	      <f name="b.materialId" alias="" ctype="" />
	      <f name="b.materialName" alias="" ctype="" />
	      <f name="b.rawType" alias="" ctype="" />
	      <f name="b.quantity" alias="" ctype="" />
	      <f name="b.quantityOnHand" alias="" ctype="" />
	      <f name="b.availabelToPromise" alias="" ctype="" />
	      <f name="IFNULL(c.quantity,'0')" alias="totalRequisition" ctype="" />
	      <f name="IFNULL(d.quantity,'0')" alias="requisitionQty" ctype="" />
	      <f name="b.unit" alias="" ctype="计量单位" />
	      <f name="b.unit" alias="unitId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
   <!--from>v_rawrequirement b LEFT JOIN v_stockoutdetailgroup c ON b.materialId = c.materialId AND c.YSId=b.YSId  LEFT JOIN v_requisitiondetailgroup d ON b.materialId=d.materialId AND d.YSId = b.YSId </from -->
   <from>v_rawrequirement b LEFT JOIN  ( SELECT 	a.stockOutId AS stockoutid, 	b.requisitionId AS requisitionId, 	b.YSId AS YSId, 	a.materialId AS materialId, 	COUNT(a.materialId) countQty, 	sum(REPLACE (ifnull(a.quantity, 0),',','')) AS quantity, 	a.price, 	max(b.checkOutDate) checkOutDate, 	b.keepUser, 	a.deleteFlag AS deleteFlag FROM  		b_stockoutdetail a 		LEFT JOIN b_stockout b ON a.stockOutId = b.stockOutId AND (b.deleteFlag = '0')    WHERE a.deleteFlag = '0' AND b.YSId='#' GROUP BY 	a.materialId  )   c ON b.materialId = c.materialId AND c.YSId = b.YSId    LEFT JOIN   ( SELECT 	a.requisitionId AS detailRequisitionId, 	b.requisitionId AS requisitionId, 	b.YSId AS YSId, 	b.YSId AS requistionYsid, 	a.materialId AS materialId, 	IFNULL(b.collectYsid,b.YSId) collectYsid, 	b.requisitionDate, 	sum( 		REPLACE ( 			ifnull(a.quantity, 0), 			',', 			'' 		) 	) AS quantity, 	sum( 		REPLACE ( 			ifnull(a.overQuantity, 0), 			',', 			'' 		) 	) AS overQuantity, 	a.deleteFlag AS deleteFlag FROM  		b_requisitiondetail a 		JOIN b_requisition b ON a.requisitionId = b.requisitionId AND b.deleteFlag='0' 			 WHERE 	a.deleteFlag = '0' AND b.YSId='#' GROUP BY a.materialId  ) d ON b.materialId = d.materialId AND d.YSId = b.YSId where b.deleteFlag='0'</from>
    <orderby>b.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="getOrderListForZZ" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"       des=""  reqName="YSId"      dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.PIId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.quantity" alias="" ctype="" />
      <f name="b.price" alias="" ctype="" />
      <f name="b.totalprice" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="b.status" alias="statusName" ctype="订单状态" />
      <f name="b.status" alias="" ctype="" />
      <f name="b.returnQuantity" alias="" ctype="" />
      <f name="b.orderCost" alias="" ctype="" />
      <f name="b.orderDate" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.storageDate" alias="" ctype="" />
      <f name="b.rebateRate" alias="" ctype="" />
      <f name="a.rawMaterialId" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
    </select>
    <from>v_orderdetailforzz AS A LEFT JOIN v_orderlist b ON a.YSId=b.ysid AND b.deleteFlag='0'</from>
    <orderby>A.YSId </orderby>
    <groupby></groupby>
    <having>b.YSId > 0</having>
	<power>
	</power>    
  </query> 
  <query>
    <pool></pool>     
    <name value="requisitionListForF02" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"       des=""  reqName="YSId"      dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.PIId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.quantity" alias="" ctype="" />
      <f name="b.price" alias="" ctype="" />
      <f name="b.totalprice" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="b.status" alias="statusName" ctype="订单状态" />
      <f name="b.status" alias="" ctype="" />
      <f name="b.returnQuantity" alias="" ctype="" />
      <f name="b.orderCost" alias="" ctype="" />
      <f name="b.orderDate" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.storageDate" alias="" ctype="" />
      <f name="b.rebateRate" alias="" ctype="" />
      <f name="a.rawMaterialId" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
      <f name="IFNULL(c.requisitionSts,'010')" alias="requisitionSts" ctype="" />
      <f name="IFNULL(IFNULL(c.quantity,b.stockOutQty),0)" alias="requisitionQty" ctype="" />
      <f name="IFNULL(c.YSId,'')" alias="taskId" ctype="" />
      <f name="IFNULL(c.requistionYsid,'')" alias="requistionYsid" ctype="" />
      <f name="IFNULL(c.collectYsid,'')" alias="collectYsid" ctype="" />
      <f name="IFNULL(IFNULL(b.virtualQty,d.quantity),0)" alias="bstockinQty" ctype="" />
    </select>
    <!-- 吹塑待领料 -->
    <from>v_orderdetailforf02 AS A 
    	JOIN v_orderdetail b ON a.YSId=b.ysid 
    	LEFT JOIN v_requisition_group_ysid_f02 c ON a.YSId=c.Ysid
    	LEFT JOIN v_purchasestockindetailgroup d ON d.YSId=a.YSId AND left(d.materialId,1)='I' </from>
    <orderby>A.YSId </orderby>
    <groupby></groupby>
    <having>#</having>
	<power>
	</power>    
  </query> 
  <query>
    <pool></pool>     
    <name value="requisitionListForF01" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"       des=""  reqName="YSId"      dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.PIId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.quantity" alias="" ctype="" />
      <f name="b.price" alias="" ctype="" />
      <f name="b.totalprice" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="b.status" alias="statusName" ctype="订单状态" />
      <f name="b.status" alias="" ctype="" />
      <f name="b.returnQuantity" alias="" ctype="" />
      <f name="b.orderCost" alias="" ctype="" />
      <f name="b.orderDate" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.storageDate" alias="" ctype="" />
      <f name="b.rebateRate" alias="" ctype="" />
      <f name="a.rawMaterialId" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
      <f name="IFNULL(c.requisitionSts,'010')" alias="requisitionSts" ctype="" />
      <f name="IFNULL(IFNULL(c.quantity,b.stockOutQty),0)" alias="requisitionQty" ctype="" />
      <f name="IFNULL(c.YSId,'')" alias="taskId" ctype="" />
      <f name="IFNULL(c.requistionYsid,'')" alias="requistionYsid" ctype="" />
      <f name="IFNULL(c.collectYsid,'')" alias="collectYsid" ctype="" />
      <f name="b.virtualQty" alias="" ctype="" />
      <f name="d.quantity" alias="stockinQty" ctype="" />
      <f name="IFNULL(IFNULL(b.virtualQty,d.quantity),0)" alias="bstockinQty" ctype="" />
    </select>
    <!-- 吸塑 -->
    <from>v_orderdetailforf01 AS A  
    	JOIN v_orderdetail b ON a.YSId=b.ysid 
    	LEFT JOIN v_requisition_group_ysid_f01 c ON a.YSId=c.YSId 
    	LEFT JOIN v_purchasestockindetailgroup d ON d.YSId=a.YSId AND left(d.materialId,1)='I' </from>
    <orderby>A.YSId </orderby>
    <groupby></groupby>
    <having>#</having>
	<power>
	</power>    
  </query> 
  <query>
    <pool></pool>     
    <name value="requisitionListForB01" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"       des=""  reqName="YSId"      dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.PIId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.quantity" alias="" ctype="" />
      <f name="b.price" alias="" ctype="" />
      <f name="b.totalprice" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="b.status" alias="statusName" ctype="订单状态" />
      <f name="b.status" alias="" ctype="" />
      <f name="b.returnQuantity" alias="" ctype="" />
      <f name="b.orderCost" alias="" ctype="" />
      <f name="b.orderDate" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.storageDate" alias="" ctype="" />
      <f name="b.rebateRate" alias="" ctype="" />
      <f name="a.rawMaterialId" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
      <f name="IFNULL(c.requisitionSts,'010')" alias="requisitionSts" ctype="" />
      <f name="IFNULL(IFNULL(c.quantity,b.stockOutQty),0)" alias="requisitionQty" ctype="" />
      <f name="IFNULL(c.YSId,'')" alias="taskId" ctype="" />
      <f name="IFNULL(c.requistionYsid,'')" alias="requistionYsid" ctype="" />
      <f name="IFNULL(c.collectYsid,'')" alias="collectYsid" ctype="" />
      <f name="b.virtualQty" alias="" ctype="" />
      <f name="d.quantity" alias="stockinQty" ctype="" />
      <f name="IFNULL(IFNULL(b.virtualQty,d.quantity),0)" alias="bstockinQty" ctype="" />
    </select>
    <!-- 吹塑待领料 -->
    <from>v_orderdetailforb01 AS A 
    	JOIN v_orderdetail b ON a.YSId=b.ysid 
    	LEFT JOIN v_requisition_group_ysid_b01 c ON a.YSId=c.Ysid 
    	LEFT JOIN v_purchasestockindetailgroup d ON d.YSId=a.YSId AND left(d.materialId,1)='I' </from>
    <orderby>A.YSId </orderby>
    <groupby></groupby>
    <having>#</having>
	<power>
	</power>    
  </query> 
   <query>
    <pool></pool>    
    <name value="getMAXStockOutId" />
     <where>
       <w name="A.parentId" des=""  reqName="parentId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name="IFNULL(MAX(a.subId+1),1)" alias="MaxSubId" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_StockOut a</from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="requisitionList" />
    <where>
      <w name="B.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"      des=""  reqName="YSId"     dtype="ch" oper="="     lg="AND" bt="" />
   	  <w name="B.requisitionSts" des=""  reqName="requisitionSts" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="B.usedType" des=""  reqName="usedType" dtype="ch" oper="="  lg="AND" bt="" />
  	  <!--w name="left(b.materialId,1)"  des=""  reqName="makeTypeL"  dtype="ch" oper="&lt;&gt;"  lg="AND" bt="" /-->
   	  <!--w name="left(b.materialId,1)"  des=""  reqName="makeTypeG"  dtype="ch" oper="="  lg="AND" bt="" /-->
     </where>
    <select>
      <f name="b.requisitionId" alias="" ctype="" />
      <f name="b.requisitionDate" alias="" ctype="" />
      <f name="b.checkOutDate" alias="" ctype="" />
      <f name="b.recordId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.requisitionUserId" alias="" ctype="" />
      <f name="b.collectYsid" alias="" ctype="" />
      <f name="b.requisitionSts" alias="" ctype="料件出库状态" />
      <f name="b.requisitionSts" alias="requisitionStsId" ctype="" />
      <f name="b.requisitionType" alias="" ctype="领料类别" />
      <f name="b.requisitionType" alias="requisitionTypeId" ctype="" />
      <f name="b.requisitionUserName" alias="" ctype="" />
      <f name="b.stockOutId" alias="" ctype="" />
      <f name="b.fullField" alias="" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <!-- virtualClass:虚拟领料区分,060: 配件单领料  -->
    <from>v_stockoutlist AS B 
    	LEFT JOIN b_orderdetail a ON a.YSId=b.YSId AND a.orderType='010'
    	WHERE b.virtualClass='010' AND b.requisitionType &lt;&gt; '060'</from>
    <orderby>a.YSId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query> 
  <query>
    <pool></pool>     
    <name value="requisitionPartsList" />
    <where>
      <w name="B.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"      des=""  reqName="YSId"     dtype="ch" oper="="     lg="AND" bt="" />
   	  <w name="B.requisitionSts" des=""  reqName="requisitionSts" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="B.usedType" des=""  reqName="usedType" dtype="ch" oper="="  lg="AND" bt="" />
      </where>
    <select>
      <f name="b.requisitionId" alias="" ctype="" />
      <f name="b.requisitionDate" alias="" ctype="" />
      <f name="b.checkOutDate" alias="" ctype="" />
      <f name="b.recordId" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.orderQty" alias="" ctype="" />
      <f name="b.orderYsid" alias="" ctype="" />
      <f name="b.requisitionQty" alias="" ctype="" />
      <f name="b.materialId" alias="" ctype="" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.requisitionUserId" alias="" ctype="" />
      <f name="b.collectYsid" alias="" ctype="" />
      <f name="b.requisitionSts" alias="" ctype="料件出库状态" />
      <f name="b.requisitionSts" alias="requisitionStsId" ctype="" />
      <f name="b.requisitionType" alias="" ctype="领料类别" />
      <f name="b.requisitionType" alias="requisitionTypeId" ctype="" />
      <f name="b.requisitionUserName" alias="" ctype="" />
      <f name="b.stockOutId" alias="" ctype="" />
      <f name="b.fullField" alias="" ctype="" />
    </select>
    <!-- virtualClass:虚拟领料区分,010: 正常领料  -->
    <from>
		(
		SELECT
			a.recordId AS recordId,
			a.YSId AS YSId,
			a.requisitionId AS requisitionId,
			a.requisitionDate AS requisitionDate,
			ifnull(a.requisitionSts, '010') AS requisitionSts,
			ifnull(a.virtualClass,'010') virtualClass,
			ifnull(
				a.requisitionType,
				'010'
				) AS requisitionType,
			a.collectYsid AS collectYsid,
			a.usedType,
			b.YSId AS orderYsid,
			b.materialId AS materialId,
			b.materialName AS materialName,
			b.PeiYsid,
			b.totalQuantity orderQty,
			a.quantity requisitionQty,
			a.requisitionUserId AS requisitionUserId,
			d.LoginName AS requisitionUserName,
			c.checkOutDate AS checkOutDate,
			ifnull(c.stockOutId, '') AS stockOutId,
			a.deleteFlag AS deleteFlag,
			ucase(
				concat_ws(
					',',
					a.YSId,
					a.requisitionId,
					c.stockOutId,
					a.collectYsid,
					b.materialId,
					b.materialName
				)
			) AS fullField
		FROM
			v_requisitiondetail a
			JOIN v_orderlist b ON (a.YSId = b.PeiYsid) AND a.materialId=b.materialId AND b.peiYsid IS NOT NULL
			LEFT JOIN b_stockout c  ON c.requisitionId = a.requisitionId AND (c.deleteFlag = '0')
		  	LEFT JOIN s_user d      ON d.UserID = a.requisitionUserId AND (d.DeleteFlag = '0') 
		WHERE a.deleteFlag = '0' 
		) AS B WHERE b.virtualClass='010'</from>
    <orderby>b.ysid,mid(b.orderysid,LOCATE('-',b.orderysid)+1,2)+0 </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query> 
  <query>
    <pool></pool>    
    <name value="requisitionDetailById" />
    <where>
        <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="e.materialName" alias="" ctype="" />
      <f name="IFNULL(e.quantityOnHand,'0')" alias="quantityOnHand" ctype="" />
      <f name="e.availabelToPromise" alias="" ctype="" />
      <f name="e.MAPrice" alias="" ctype="" />
      <f name="a.quantity" alias="requisitionQty" ctype="" />
      <f name="b.areaNumber" alias="" ctype="" />
      <f name="IFNULL(c.unitQuantity,'1')" alias="unitQuantity" ctype="" />
      <f name="c.manufactureQuantity" alias="planQty" ctype="" />
      <f name="c.purchaseQuantity" alias="contractQty" ctype="" />
      <f name="IFNULL(d.quantity,'0')" alias="stockoutQty" ctype="" />
      <f name="IFNULL(f.quantity,'0')" alias="rawQty" ctype="" />
      <f name="IFNULL(g.totalQuantity,'0')" alias="orderQty" ctype="" />
      <f name="g.YSId" alias="orderYsid" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <!-- from>v_requisitiondetail  AS A LEFT JOIN b_rawrequirement f ON f.YSId=a.YSId AND f.materialId=a.materialId LEFT JOIN v_purchasestockin_groupby_ysid_materialid b ON b.YSId=a.YSId AND b.materialId=a.materialId  LEFT JOIN v_purchaseplandetailgroup c ON c.YSId=a.YSId AND c.materialId = a.materialId  LEFT JOIN v_stockout_groupby_requisitionid d ON d.requisitionId=a.requisitionId AND d.materialId=a.materialId LEFT JOIN b_material e ON e.materialId=a.materialId AND e.deleteFlag='0'</from -->
  <from> v_requisitiondetail AS A 
  	LEFT JOIN b_rawrequirement f ON f.YSId = a.YSId AND f.materialId = a.materialId 
  	LEFT JOIN b_orderDetail g ON g.peiYsid = a.YSId AND g.materialId = a.materialId 
  	LEFT JOIN  ( SELECT 	c.materialId, 	c.ysid, 	SUM(REPLACE(c.quantity, ',', '')) quantity, 	max(c.checkInDate) AS checkInDate, 	max(c.storageFinish) storageFinish, 	group_concat( c.areaNumber SEPARATOR ',' ) AS areaNumber FROM 	v_purchasestockindetail c WHERE 	c.deleteFlag = '0' AND c.ysid='#' GROUP BY  	c.materialId  )  b ON  b.YSId = a.YSId AND b.materialId = a.materialId LEFT JOIN  ( SELECT 	a.recordId AS recordId, 	a.purchaseId AS purchaseId, 	a.YSId AS YSId, 	a.materialId AS materialId, 	 	sum(a.unitQuantity) AS unitQuantity, 	a.supplierId AS supplierId, 	a.supplierShortName AS supplierShortName, 	IFNULL(a.price,0) AS price, 	a.priceStatus AS priceStatus, 	format( 		sum( 			REPLACE ( 				a.manufactureQuantity, 				',', 				'' 			) 		), 		2 	) AS manufactureQuantity,   	sum( REPLACE ( a.manufactureQuantity, ',', '' ) ) AS manufactureQty, 	format(sum(REPLACE (a.purchaseQuantity,',','')),2) AS purchaseQuantity, 	if(sum(a.unitQuantity)=0,1,sum(a.unitQuantity)) * REPLACE(c.totalQuantity, ',', '' ) AS orderQty,  c.totalQuantity, 	a.totalRequisition AS totalRequisition FROM  		b_purchaseplandetail a 		LEFT JOIN b_orderdetail c ON c.ysid=a.ysid AND (c.deleteFlag = '0')  WHERE a.deleteFlag='0' AND a.ysid='#'  GROUP BY  	a.materialId  )  c ON c.YSId = a.YSId AND c.materialId = a.materialId LEFT JOIN   ( SELECT 	a.stockOutId AS stockoutid, 	b.requisitionId AS requisitionId, 	b.YSId AS YSId, 	a.materialId AS materialId, 	COUNT(a.materialId) countQty, 	sum(REPLACE (ifnull(a.quantity, 0),',','')) AS quantity, 	a.price, 	max(b.checkOutDate) checkOutDate, 	b.keepUser, 	a.deleteFlag AS deleteFlag FROM  		b_stockoutdetail a 		JOIN b_stockout b ON a.stockOutId = b.stockOutId AND (b.deleteFlag = '0')   WHERE (a.deleteFlag = '0') AND 	b.YSId='#'  GROUP BY 	a.materialId  )  d ON d.requisitionId = a.requisitionId AND d.materialId = a.materialId LEFT JOIN b_material e ON e.materialId = a.materialId AND e.deleteFlag = '0' WHERE a.deleteFlag='0'</from>
    <orderby>A.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="stockoutListById" />
     <where>
       <w name="A.YSId" des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
       <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.checkOutDate" alias="" ctype="" />
      <f name="a.stockOutId" alias="" ctype="" />
      <f name="b.loginName" alias="keepUser" ctype="" />  
      <f name="a.deleteFlag" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>b_stockout a LEFT JOIN s_user b ON a.keepUser=b.UserID AND b.deleteFlag='0' where a.deleteFlag='0'</from>
    <orderby>a.requisitionId </orderby>
    <groupby></groupby>
    <having></having>
	<power>
	</power>    
  </query>
  <query>
    <pool></pool>    
    <name value="stockoutdetail" />
     <where>
       <w name="A.stockOutId" des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.stockOutId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" /> 
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.price" alias="" ctype="" />
      <f name="a.checkOutDate" alias="" ctype="" />
      <f name="a.keepUser" alias="" ctype="" />
      <f name="b.unitQuantity" alias="" ctype="" />
      <f name="c.totalQuantity" alias="" ctype="" />
      <f name="b.unitQuantity * REPLACE(c.totalQuantity,',','')" alias="orderCount" ctype="" />
      <f name="b.manufactureQuantity" alias="" ctype="" />
      <f name="a.depotId" alias="" ctype="仓库分类" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_stockout a LEFT JOIN v_purchaseplan b ON a.YSId=b.YSId AND a.materialId=b.materialId LEFT JOIN v_orderdetail c ON a.YSId=c.YSId  </from>
    <orderby>a.materialId </orderby>
    <groupby></groupby>
    <having></having>
	<power>
	</power>    
  </query>
  <query>
    <pool></pool>    
    <name value="stockoutDetailParts" />
     <where>
       <w name="A.stockOutId" des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.YSId" alias="stockoutYsid" ctype="" />
      <f name="c.YSId" alias="" ctype="" />
      <f name="a.stockOutId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" /> 
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.price" alias="" ctype="" />
      <f name="a.checkOutDate" alias="" ctype="" />
      <f name="a.keepUser" alias="" ctype="" />
      <f name="c.totalQuantity" alias="" ctype="" />
      <f name="a.depotId" alias="" ctype="仓库分类" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from>v_stockout a 
    	LEFT JOIN v_orderdetail c ON a.YSId=c.PeiYsid  AND c.materialId=a.materialId </from>
    <orderby>mid(c.YSId,LOCATE('-',c.YSId)+1,2)+0 </orderby>
    <groupby></groupby>
    <having></having>
	<power>
	</power>    
  </query>
  <query>
    <pool></pool>    
    <name value="zzmaterialFromPlan" />
     <where>
       <w name="b.YSId" des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  <select>
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.materialId" alias="" ctype="" />
      <f name="c.materialName" alias="" ctype="" /> 
      <f name="d.rawmaterialId" alias="" ctype="" />
      <f name="b.manufactureQuantity" alias="" ctype="" />
      <f name="b.purchaseQuantity" alias="" ctype="" />
      <f name="c.unit" alias="" ctype="计量单位" />
      <f name="b.purchaseType" alias="" ctype="" />
      <f name="b.deleteFlag" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <from> v_purchaseplandetailgroup b LEFT JOIN  b_material c ON b.materialId=c.materialId AND c.deleteFlag='0' LEFT JOIN b_zzrawmaterial d ON d.materialId=b.materialId AND d.deleteFlag='0' WHERE b.supplierId='0574YZ00' AND LEFT(b.materialId,1) != 'H' AND b.deleteFlag='0' </from>
    <orderby>b.YSId,b.materialId </orderby>
    <groupby>b.YSId,b.materialId</groupby>
    <having>cast(b.purchaseQuantity AS DECIMAL (10, 0)) > 0</having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="requisitionPrint" />
    <where>
        <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.detailRecordId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.contractId" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="c.quantity" alias="" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="a.overQuantity" alias="" ctype="" />
      <f name="a.subBomNo" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_requisitiondetail  AS A LEFT JOIN  v_stockout c ON a.requisitionId = c.requisitionId AND  c.materialId = a.materialId AND c.subBomNo = a.subBomNo AND c.deleteFlag = '0' WHERE  A.deleteFlag = '0'</from>
    <orderby>A.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="requisitionEdit" />
    <where>
        <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.requisitionUserId" alias="" ctype="" />
      <f name="c.collectYsid" alias="" ctype="" />
      <f name="c.taskId" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>b_Requisition  AS A LEFT JOIN  b_ProductionTask c ON a.YSId = c.taskId  AND c.deleteFlag = '0' WHERE  A.deleteFlag = '0'</from>
    <orderby>A.requisitionId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="stockoutForfinance" />
    <where>
      <w name="B.fullField" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.fullField" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="B.YSId"      des=""  reqName="YSId"     dtype="ch" oper="="     lg="AND" bt="" />
   	  <w name="B.requisitionSts" des=""  reqName="requisitionSts" dtype="ch" oper="="  lg="AND" bt="" />

   	  <w name="b.checkOutDate" des=""  reqName="stockOutDateStart" dtype="ch" oper="&gt;="  lg="AND" bt="" />
   	  <w name="b.checkOutDate" des=""  reqName="stockOutDateEnd" dtype="ch" oper="&lt;="  lg="AND" bt="" />
     </where>
    <select>    
      <f name="b.checkOutDate" alias="" ctype="" />
      <f name="b.YSId" alias="" ctype="" />
      <f name="b.materialId" alias="" ctype="" />
      <f name="c.supplierId" alias="" ctype="" />
      <f name="c.price" alias="" ctype="" />
      <f name="c.manufactureQuantity" alias="" ctype="" />
      <f name="c.purchaseQuantity" alias="" ctype="" />
      <f name="b.unit" alias="" ctype="计量单位" />
      <f name="b.materialName" alias="" ctype="" />
      <f name="b.stockOutId" alias="" ctype="" />
      <f name="b.collectYsid" alias="" ctype="" />
      <f name="b.depotId" alias="depotName" ctype="仓库分类" />
      <f name="format(replace(b.quantity,',',''),2)" alias="quantity" ctype="" />
      <f name="b.fullField" alias="" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <!-- status = '0' 表示 订单状态为 "新建"  A.status = '0' AND   -->
    <from>v_stockoutforfinance AS b LEFT JOIN v_purchaseplandetailgroup c ON c.ysid=b.ysid AND c.materialId=b.materialId AND c.deleteFlag='0'  WHERE b.deleteFlag='0' </from>
    <orderby>b.stockOutId,b.materialId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="getOrderListForRequisition" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.orderQty" alias="" ctype="" />
      <f name="A.totalRequisition" alias="" ctype="" />
      <f name="A.manufactureQty" alias="" ctype="" />
      <f name="A.requisitionQty" alias="" ctype="" />
      <f name="A.requisitionDate" alias="" ctype="" />
      <f name="A.deliveryDate" alias="" ctype="" />
      <f name="A.stockinQty" alias="" ctype="" />
      <f name="A.virtualQty" alias="" ctype="" />
      <f name="A.orderType" alias="" ctype="" />
      <f name="IFNULL(IFNULL(A.virtualQty,A.stockinQty),0)" alias="bstockinQty" ctype="" />
    </select>
    <from>v_requisitionforzhuangpei a WHERE a.orderType='010'</from>
    <orderby>A.YSId</orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>  
  <query>
    <pool></pool>     
    <name value="getOrderListForRequisitionParts" /><where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.peiYsid"    des=""  reqName="peiYsid"   dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="A.status"     des=""  reqName="status" dtype="ch" oper="in"  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.peiYsid" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="b.requisitionId" alias="" ctype="" />
      <f name="(IFNULL(REPLACE(b.quantity,',',''),0))" alias="requisitionQty" ctype="" />
      <f name="(b.requisitionDate)" alias="requisitionDate" ctype="" />
      <f name="(IFNULL(REPLACE(c.quantity,',',''),0))" alias="stockoutQty" ctype="" />
      <f name="(c.checkOutDate)" alias="checkOutDate" ctype="" />
      <f name="b.recordId" alias="requisitionRecordId" ctype="" />
      <f name="A.recordId" alias="" ctype="" />
      <f name="A.detailRecordId" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.PIId" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.price" alias="" ctype="" />
      <f name="A.totalprice" alias="" ctype="" />
      <f name="A.totalQuantity" alias="" ctype="" />
      <f name="A.shippingCase" alias="" ctype="" />
      <f name="A.loadingPort" alias="" ctype="" />
      <f name="A.orderDate" alias="" ctype="" />
      <f name="A.orderId" alias="" ctype="" />
      <f name="A.orderRecordId" alias="" ctype="" />
      <f name="A.deliveryDate" alias="" ctype="" />
      <f name="A.unit" alias="" ctype="计量单位" />
      <f name="A.currency" alias="" ctype="币种" />
      <f name="A.currency" alias="currencyId" ctype="" />
      <f name="A.customerFullName" alias="" ctype="" />
      <f name="A.sysValue" alias="" ctype="" />
      <f name="A.team" alias="" ctype="业务组" />
      <f name="A.orderCompany" alias="" ctype="" />
      <f name="A.productClassify" alias="productClassifyName" ctype="版本类别" />
      <f name="A.productClassify" alias="" ctype="" />
      <f name="A.orderType" alias="" ctype="" />
      <f name="A.orderNature" alias="orderNatureName" ctype="订单性质" />
      <f name="A.orderNature" alias="" ctype="" />
      <f name="A.status" alias="statusName" ctype="订单状态" />
      <f name="A.status" alias="" ctype="" />
      <f name="A.returnQuantity" alias="" ctype="" />
      <f name="A.orderCost" alias="" ctype="" />
      <f name="A.storageDate" alias="" ctype="" />
      <f name="A.rebateRate" alias="" ctype="" />
      <f name="A.completedQuantity" alias="" ctype="" />
      <f name="A.completedNumber" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
      <f name="A.quantityOnHand" alias="" ctype="" />
      <f name="A.discount" alias="" ctype="" />
      <f name="A.commission" alias="" ctype="" />
      <f name="A.customerId" alias="" ctype="" />
      <f name="A.shortName" alias="" ctype="" />
      <f name="IFNULL(IFNULL(c.quantity,a.orderStockoutQty),0)" alias="orderStockoutQty" ctype="" />
    </select>
    <from>( SELECT 	A.recordId, 	A.detailRecordId, 	A.materialId, 	A.materialName, 	A.PIId, 	A.YSId, 	A.quantity, 	A.price, 	A.totalprice, 	A.totalQuantity, 	A.shippingCase, 	A.loadingPort, 	A.orderDate, 	A.orderId, 	A.orderRecordId, 	A.deliveryDate, 	A.unit, 	A.currency, A.customerFullName, 	A.sysValue, 	A.team, 	A.orderCompany, A.productClassify, 	A.orderType, A.orderNature, 	A. STATUS, 	A.returnQuantity, 	A.orderCost, 	A.storageDate, 	A.rebateRate, 	A.completedQuantity, 	A.completedNumber, 	A.full_field, 	A.peiYsid, 	A.quantityOnHand, 	IFNULL(A.rebate, '0') discount, 	IFNULL(A.commission, '0') commission, 	
    			A.customerId,
    			A.stockOutQty AS orderStockoutQty,
    			A.shortName 
    		FROM 	v_orderlist AS A WHERE 	orderType = '020'  
    	) a  
    	LEFT JOIN v_requisitiondetail b ON a.peiYsid=b.YSId AND a.materialId=b.materialId 
    	LEFT JOIN v_stockout c ON a.peiYsid=c.YSId AND a.materialId=c.materialId 
    	WHERE 1=1 </from>
    <orderby>LEFT(A.YSId, 8) ,	mid(A.YSId,	LOCATE('-', A.YSId) + 1,2) + 0</orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="getRequisitionPartsAndWaitOut" /><where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.peiYsid"    des=""  reqName="peiYsid"   dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="A.status"     des=""  reqName="status" dtype="ch" oper="in"  lg="AND" bt="" />
     </where>
    <select>
      <f name="b.YSId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.requisitionSts" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.totalQuantity" alias="" ctype="" />
      <f name="a.quantity" alias="requisitionQty" ctype="" />
      <f name="a.YSId" alias="peiYsid" ctype="" />
    </select>
    <from>v_requisitiondetail a
			JOIN v_orderdetail b ON a.YSId=b.peiYsid AND a.materialId=b.materialId AND b.orderType='020'
			WHERE a.requisitionSts='020' </from>
    <orderby>LEFT(b.YSId, 8) ,	mid(b.YSId,	LOCATE('-', b.YSId) + 1,2) + 0</orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>  
  <query>
    <pool></pool>     
    <name value="getRequisitionListForExcess" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.excessType" des=""  reqName="excessType" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="b.materialId" alias="productId" ctype="" />
      <f name="b.materialName" alias="productName" ctype="" />
      <f name="A.requisitionId" alias="" ctype="" />
      <f name="A.excessType" alias="" ctype="超领区分" />
      <f name="A.virtualClass" alias="" ctype="虚拟领料区分" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.remarks" alias="" ctype="" />
      <f name="A.requisitionDate" alias="" ctype="" />
      <f name="b.totalQuantity" alias="orderQty" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
    </select>
    <from>v_requisitiondetail a left join v_orderdetail b on a.ysid=b.ysid</from>
    <orderby>A.YSId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query> 
  <query>
    <pool></pool>     
    <name value="getRequisitionDetailForExcess" />
    <where>
   	  <w name="A.excessType" des=""  reqName="excessType" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="A.requisitionId" des=""  reqName="requisitionId" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="a.recordId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="A.requisitionId" alias="" ctype="" />
      <f name="A.excessType" alias="" ctype="超领区分" />
      <f name="A.virtualClass" alias="" ctype="虚拟领料区分" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="FORMAT(replace(A.scrapQuantity,',',''),2)" alias="scrapQuantity" ctype="" />
      <f name="A.remarks" alias="" ctype="" />
      <f name="FORMAT(replace(A.quantity,',',''),2)" alias="quantity" ctype="" />
      <f name="A.requisitionDate" alias="" ctype="" />
      <f name="FORMAT(replace(b.totalQuantity,',',''),2)" alias="orderQty" ctype="" />
      <f name="b.deliveryDate" alias="" ctype="" />
      <f name="b.materialId" alias="productId" ctype="" />
      <f name="b.materialName" alias="productName" ctype="" />
      <f name="IFNULL(c.stockOutId,'')" alias="stockOutId" ctype="" />
      <f name="FORMAT(IFNULL(replace(c.quantity,',',''),'0'),2)" alias="stockoutQty" ctype="" />
      <f name="d.contractId" alias="" ctype="" />
      <f name="d.supplierId" alias="" ctype="" />
    </select>
    <from>v_requisitiondetail a left join v_purchaseorderddeduct_group d on a.YSId=d.YSId AND a.materialId=d.materialId left join v_stockout c on a.requisitionId=c.requisitionId AND a.materialId=c.materialId left join v_orderdetail b on a.ysid=b.ysid</from>
    <orderby>A.materialId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="getOrderListForRequisitionVirtual" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="left(A.YSId,2)" des=""  reqName="YsYear" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="A.virtualClass" des=""  reqName="virtualClass" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.orderQty" alias="" ctype="" />
      <f name="A.manufactureQty" alias="" ctype="" />
      <f name="A.requisitionQty" alias="" ctype="" />
      <f name="A.requisitionDate" alias="" ctype="" />
      <f name="A.deliveryDate" alias="" ctype="" />
      <f name="A.virtualClass" alias="" ctype="" />
    </select>
    <from>v_requisitionforzhuangpei a</from>
    <orderby>A.YSId</orderby>
    <groupby></groupby>
    <having>#</having>
	<power></power>    
  </query>
  <query>
    <pool></pool>     
    <name value="getRequisitionAndStockout" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="a.requisitionSts"  des=""  reqName="requisitionSts" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.full_field" alias="" ctype="" />
      <f name="A.recordId" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.unit" alias="" ctype="计量单位" />
      <f name="A.requisitionUserId" alias="" ctype="" />
      <f name="a.requisitionId" alias="" ctype="" />
      <f name="a.requisitionDate" alias="" ctype="" />
      <f name="a.requisitionSts" alias="" ctype="料件出库状态" />
      <f name="b.checkOutDate" alias="" ctype="" />
      <f name="b.stockOutId" alias="" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <!-- status = '0' 表示 订单状态为 "新建"  A.status = '0' AND   -->
    <from>v_requisitiondetail a LEFT JOIN b_stockout b ON b.requisitionId=a.requisitionId AND b.deleteFlag='0' WHERE a.deleteFlag='0' AND LEFT(a.requisitionType,2)='05'</from>
    <orderby>a.requisitionId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="stockoutforproduct" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="a.YSId"  	  des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
    <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.PIId" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.stockOutQty" alias="" ctype="" />
      <f name="A.quantity" alias="orderQty" ctype="" />
      <f name="A.completedQuantity" alias="stockinQty" ctype="" />
      <f name="A.completedQuantity" alias="" ctype="" />
      <f name="A.unit" alias="" ctype="计量单位" />
      <f name="A.storageDate" alias="" ctype="" />
      <f name="a.stockOutDate" alias="stockoutDate" ctype="" />
      <f name="a.deliveryDate" alias="" ctype="" />
      <f name="a.status" alias="" ctype="订单状态" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
    <!-- status = '0' 表示 订单状态为 "新建"  A.status = '0' AND   -->
    <from>v_orderlist a WHERE 1=1 AND REPLACE(a.quantity,',','')+0 >0  #</from>
     <orderby>a.YSId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="stockinforproduct" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="a.YSId"  	  des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="a.stockOutId"  des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="a.status"  des=""  reqName="status" dtype="ch" oper="not in"  lg="AND" bt="" />
   	  <w name="LEFT(a.storageDate,7)"  des=""  reqName="storageMonth" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.PIId" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.orderQty" alias="" ctype="" />
      <f name="A.stockinQty" alias="" ctype="" />
      <f name="A.completedQuantity" alias="" ctype="" />
      <f name="A.unit" alias="" ctype="计量单位" />
      <f name="A.storageDate" alias="" ctype="" />
      <f name="LEFT(a.storageDate,7)" alias="storageMonth" ctype="" />
      <f name="a.status" alias="" ctype="订单状态" />
      <f name="a.status" alias="statusId" ctype="" />
      <f name="a.team" alias="" ctype="业务组" />
    </select>
    <!--from>v_stockoutforproduct a LEFT JOIN v_stockout_createtime_max c ON c.YSId=a.YSId AND c.materialId=a.materialId WHERE a.deleteFlag='0' #</from -->
    <from>
    	( SELECT
			a.YSId,
			a.materialId,
			a.materialName,
			a.PIId,
			IFNULL(REPLACE(a.quantity,',',''),'0') orderQty,
			IFNULL(REPLACE(c.quantity,',',''),'0') stockinQty,
			c.checkInDate AS storageDate,
			a.unit,
			a.team,
			IFNULL(a.completedQuantity,0) completedQuantity,
			a.status,full_field
		from v_orderlist a
			LEFT JOIN v_purchasestockindetailgroup c ON c.materialId=a.materialId AND c.YSId=a.YSId
		WHERE REPLACE(a.quantity,',','')+0 > 0 
    ) a where 1=1 #0
    </from>
    <orderby>a.YSId </orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="stockoutHistory" />
    <where>
   	  <w name="a.YSId"  des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="a.stockOutId"  des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
    <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.stockOutId" alias="" ctype="" />
      <f name="A.requisitionId" alias="" ctype="" />
      <f name="A.keepUser" alias="" ctype="" />
      <f name="B.loginName" alias="" ctype="" />
      <f name="A.checkOutDate" alias="" ctype="" />
      <f name="A.stockoutType" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.price" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="c.materialId" alias="productId" ctype="" />
      <f name="c.materialName" alias="productName" ctype="" />
      <f name="c.totalQuantity" alias="orderQty" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>v_stockout a LEFT JOIN v_orderlist c ON c.YSId=a.YSId LEFT JOIN s_user b ON a.keepUser=b.UserID AND b.deleteFlag='0' WHERE a.deleteFlag='0' </from>
    <orderby>a.stockOutId</orderby>
    <groupby>A.stockOutId</groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="stockoutHistoryForProduct" />
    <where>
   	  <w name="a.YSId"  des=""  reqName="YSId"  dtype="ch" oper="="  lg="AND" bt="" />
      <w name="a.YSId"  des=""  reqName="ysids" dtype="ch" oper="in" lg="AND" bt="" />
   	  <w name="a.stockOutId"  des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
    <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.stockOutId" alias="" ctype="" />
      <f name="A.requisitionId" alias="" ctype="" />
      <f name="A.keepUser" alias="" ctype="" />
      <f name="B.loginName" alias="" ctype="" />
      <f name="A.checkOutDate" alias="" ctype="" />
      <f name="A.stockoutType" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.price" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="c.quantity" alias="orderQty" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>v_stockout a  
    	JOIN s_user b ON a.keepUser=b.UserID AND b.deleteFlag='0' 
    	JOIN b_orderdetail c ON c.YSId=a.YSId AND a.materialId=c.materialId AND c.deleteFlag='0' 
    	WHERE a.deleteFlag='0' </from>
    <orderby>A.YSId,a.stockOutId</orderby>
    <groupby>A.stockOutId</groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>     
    <name value="stockoutByMaterialId" />
    <where>
   	  <w name="a.materialId"  des=""  reqName="materialId" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="a.YSId"  des=""  reqName="YSId" dtype="ch" oper="="  lg="AND" bt="" />
   	  <w name="a.stockOutId"  des=""  reqName="stockOutId" dtype="ch" oper="="  lg="AND" bt="" />
     </where>
    <select>
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.stockOutId" alias="" ctype="" />
      <f name="A.requisitionId" alias="" ctype="" />
      <f name="A.keepUser" alias="" ctype="" />
      <f name="B.loginName" alias="" ctype="" />
      <f name="A.checkOutDate" alias="" ctype="" />
      <f name="A.stockoutType" alias="" ctype="" />
      <f name="A.quantity" alias="" ctype="" />
      <f name="A.price" alias="" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
    </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>v_stockout a  LEFT JOIN s_user b ON a.keepUser=b.UserID AND b.deleteFlag='0' WHERE a.deleteFlag='0' </from>
    <orderby>a.stockOutId</orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="getMAXContractByMaterialId" />
     <where>
       <w name="e.materialId" des=""  reqName="materialId" dtype="ch" oper="="  lg="" bt="" />
    </where>
  <select>
      <f name="e.YSId" alias="" ctype="" />
      <f name="e.contractId" alias="" ctype="" />
      <f name="e.supplierId" alias="" ctype="" />
      <f name="e.materialId" alias="" ctype="" />
      <f name="e.quantity" alias="" ctype="" />
      <f name="e.purchaseDate" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <from>v_purchaseorderdetail e ,	(	SELECT	c.contractId,	max(c.purchaseDate) purchaseDate	FROM	(		SELECT		a.contractId,		a.purchaseDate,		b.paymentId		FROM		v_purchaseorderdetail a LEFT JOIN v_paymentdetail b ON a.contractId=b.contractId		WHERE a.materialId='#' 		 ORDER BY a.materialId,a.purchaseDate DESC	) c	WHERE c.paymentId IS NULL ) d WHERE e.contractId=d.contractId </from>
    <orderby></orderby>
    <groupby></groupby>
    <having></having>
	<power></power>
  </query>
  <query>
    <pool></pool>    
    <name value="purchasePlanForExcess" />
    <where>
    	<w name="A.YSId" des="" reqName="YSId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.supplierId" alias="" ctype="" />
      <f name="a.quantityOnHand" alias="" ctype="" />
      <f name="a.availabelToPromise" alias="" ctype="" />
      <f name="a.unit" alias="" ctype="计量单位" />
      <f name="a.purchaseType" alias="purchaseTypeName" ctype="物料采购类别" />
      <f name="a.purchaseType" alias="" ctype="" />
      <f name="a.subBomNo" alias="" ctype="" />
      <f name="b.materialId" alias="productId" ctype="" />
      <f name="b.materialName" alias="productName" ctype="" />
      <f name="b.totalQuantity" alias="orderQty" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_purchaseplan AS A LEFT JOIN v_orderdetail b ON a.ysid=b.ysid</from>
    <groupby></groupby>
    <having></having>
    <orderby>a.materialId</orderby>
	<power></power>    
  </query>
  <query>
    <pool></pool>    
    <name value="getStockoutAndRequiztionDetailById" />
    <where>
    	<w name="A.YSId"       des="" reqName="YSId"       dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="A.materialId" des="" reqName="materialId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
      <f name="a.YSId" alias="" ctype="" />
      <f name="a.materialId" alias="" ctype="" />
      <f name="a.materialName" alias="" ctype="" />
      <f name="a.remarks" alias="" ctype="" />
      <f name="IFNULL(a.excessType,'010')" alias="excessType" ctype="超领区分" />
      <f name="a.quantity" alias="" ctype="" />
      <f name="b.quantity" alias="stockoutQty" ctype="" />
      <f name="b.stockOutId" alias="" ctype="" />
      <f name="b.checkOutDate" alias="" ctype="" />
  </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
    <!-- $：由程序根据where句的情况追加where关键字' 无$：程序不负责追加where关键字，在from句中需写入where关键字 -->
   <from>v_stockout b,v_requisitiondetail a
		WHERE a.YSId=b.YSId 
			AND a.materialId=b.materialId 
			AND a.requisitionId=b.requisitionId</from>
    <groupby></groupby>
    <having></having>
    <orderby>a.requisitionId</orderby>
	<power></power>    
  </query> <query>
    <pool></pool>    
    <name value="getProductStockoutQtyById" />
    <where>
    	<w name="b.YSId"       des="" reqName="YSId"       dtype="ch" oper="=" lg="AND" bt="" />
    	<w name="a.materialId" des="" reqName="materialId" dtype="ch" oper="=" lg="AND" bt="" />
    </where>
  	<select>
	      <f name="b.YSId" alias="parentMaterialId" ctype="" />
	      <f name="a.materialId" alias="" ctype="" />
	      <f name="sum(REPLACE (ifnull(a.quantity, 0),',',	''))" alias="stockoutQty" ctype="" />
	      <f name="max(b.checkOutDate)" alias="stockoutDate" ctype="" />
   </select>
    <!-- 条件可以获得系统变量值 '@:来源session,#来源 2016/1/8未实现' -->
   <from>		
		b_stockoutdetail a
		JOIN b_stockout b ON a.stockOutId = b.stockOutId AND b.deleteFlag = '0'
	 	WHERE a.deleteFlag = '0'
	</from>
    <orderby></orderby>
    <groupby>b.YSId, a.materialId </groupby>
    <having></having>
	<power></power>    
  </query>
  <!-- getOrderListForTask 生产任务同步 -->
  <query>
    <pool></pool>     
    <name value="getProduceTaskForRequisition" />
    <where>
      <w name="A.full_field" des=""  reqName="keyword1" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.full_field" des=""  reqName="keyword2" dtype="ch" oper="like"  lg="AND" bt="" />
   	  <w name="A.orderType"  des=""  reqName="orderType" dtype="ch" oper="="  lg="AND" bt="" />
    </where>
    <select>
      <f name="IFNULL(A.machineModel,'')" alias="machineModel" ctype="" />
      <f name="IFNULL(b.YSId,'')" alias="mergeYsid" ctype="" />
      <f name="IF(b.mergeId IS NULL,'0','1')" alias="lastCheceked" ctype="" />
      <f name="b.viewFlag" alias="" ctype="" />
      <f name="b.mergeId" alias="" ctype="" />
      <f name="IFNULL(c.YSId,'')" alias="hideYsid" ctype="" />
      <f name="IFNULL(c.hideFlag,'F')" alias="hideFlag" ctype="" />
      <f name="A.materialId" alias="" ctype="" />
      <f name="A.materialName" alias="" ctype="" />
      <f name="A.PIId" alias="" ctype="" />
      <f name="A.YSId" alias="" ctype="" />
      <f name="A.computeStockinQty" alias="" ctype="" />
      <f name="A.orderQty" alias="" ctype="" />
      <f name="A.totalQuantity" alias="" ctype="" />
      <f name="A.orderDate" alias="" ctype="" />
      <f name="A.deliveryDate" alias="" ctype="" />
      <f name="A.deliveryDate" alias="MaxDeliveryDate" ctype="" />
      <f name="A.currency" alias="" ctype="币种" />
      <f name="A.currency" alias="currencyId" ctype="" />
      <f name="A.team" alias="" ctype="业务组" />
      <f name="A.orderType" alias="" ctype="" />
      <f name="A.completedQuantity" alias="" ctype="" />
      <f name="A.customerId" alias="" ctype="" />
      <f name="A.shortName" alias="" ctype="" />
      <f name="A.divertYsid" alias="" ctype="" />
      <f name="A.diverFlag" alias="" ctype="" />
      <f name="d.status" alias="currentSts" ctype="" />
      <f name="d.followType" alias="currentType" ctype="" />
    </select>
    <!-- status = '0' 表示 订单状态为 "新建"  A.status = '0' AND   -->
    <from>
      (
		SELECT
			COUNT(a.stockinQty) stockinCnt,
			SUM(a.stockinQty) stockinQty,
			a.completedQuantity,
			IF(SUM(a.stockinQty) &lt;=0,a.completedQuantity,SUM(a.stockinQty)) computeStockinQty,
			MAX(a.checkInDate) checkInDate,
			a.PIId,
			a.YSId,A.machineModel,
			a.materialId,A.materialName,
			a.orderQty,a.totalQuantity,
			a.divertYsid,A.diverFlag,A.customerId,A.shortName,A.orderType,A.team,A.currency,A.deliveryDate,A.orderDate,A.totalprice,
			a.full_field
		FROM
			(
				SELECT 
					a.PIId,
					a.YSId,A.machineModel,
					a.materialId,A.materialName,
					REPLACE(a.quantity,',','') orderQty,
					REPLACE(a.totalQuantity,',','') totalQuantity,
					REPLACE(IFNULL(a.completedQuantity,0),',','') completedQuantity,
					REPLACE(IFNULL(b.quantity,0),',','') stockinQty,
					b.checkInDate,
					a.full_field,
					a.divertYsid,A.diverFlag,A.customerId,A.shortName,A.orderType,A.team,A.currency,A.deliveryDate,A.orderDate,A.totalprice
				FROM 
					v_orderlist AS a
					LEFT JOIN v_purchasestockindetail AS b ON b.YSId = a.YSId AND b.materialId=a.materialId
				WHERE SUBSTRING_INDEX(SUBSTRING_INDEX(A.materialId,'.',2),'.',-1) NOT IN ('BTR','BNC','CGR','PJ')
					  AND  #0 
			) a
			GROUP BY a.YSId,a.materialId
		 	HAVING #2
		 
      ) AS A  
    	LEFT JOIN b_OrderMergeDetail b ON a.YSId=b.ysid AND b.deleteFlag = '0'
    	LEFT JOIN b_OrderProduceHide c ON a.YSId=c.ysid AND c.deleteFlag = '0'
		LEFT JOIN b_follow  d ON a.YSId=d.YSId AND LEFT(d.followType,1)='3' AND d.deleteFlag = '0'
      WHERE 1=1 
    </from>
    <orderby>IFNULL(b.mergeId,'0')  DESC,IFNULL(b.YSId,a.YSId),mid(A.YSId,LOCATE('-',A.YSId)+1,2)+0</orderby>
    <groupby></groupby>
    <!-- hideFlag='F 不显示隐藏数据   -->
    <having>#1</having>
	<power>
	</power>    
  </query>
</root>